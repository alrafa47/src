/*
 * File: app/model/Sipas/Surat.js
 *
 * This file was generated by Sencha Architect version 3.5.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('SIPAS.model.Sipas.Surat', {
    extend: 'Ext.data.Model',

    requires: [
        'Ext.data.proxy.Ajax',
        'Ext.data.reader.Json',
        'Ext.data.Field',
        'Ext.data.association.HasOne',
        'Ext.data.association.BelongsTo',
        'Ext.data.association.HasMany'
    ],
    uses: [
        'SIPAS.model.Sipas.Arsip',
        'SIPAS.model.Sipas.Korespondensi',
        'SIPAS.model.Sipas.surat.Ulasan',
        'SIPAS.model.Sipas.surat.stack.Koreksi',
        'SIPAS.model.Sipas.surat.stack.Petikan',
        'SIPAS.model.Sipas.surat.Penerimask',
        'SIPAS.model.Sipas.surat.stack.Disposisi',
        'SIPAS.model.Sipas.surat.Log',
        'SIPAS.model.Sipas.koreksi.Riwayat',
        'SIPAS.model.Sipas.Jenis',
        'SIPAS.model.Sipas.jenis.Sub',
        'SIPAS.model.Sipas.Media',
        'SIPAS.model.Sipas.Lokasi',
        'SIPAS.model.Sipas.Kelas',
        'SIPAS.model.Sipas.Prioritas',
        'SIPAS.model.Sipas.Sifat',
        'SIPAS.model.Sipas.Unit',
        'SIPAS.model.Sipas.uni.Source'
    ],

    statics: {
        statusPenyetujuan: function() {
            return {
                PERSETUJUAN_INIT : 0,
                PERSETUJUAN_PROCESS : 1,
                PERSETUJUAN_APPROVE : 2,
                PERSETUJUAN_REVISION : 3,
                PERSETUJUAN_DECLINE : 4
            };
        },

        statusDistribusi: function() {
            return {
                DISTRIBUSI_INIT : 0,
                DISTRIBUSI_DISTRIBUTE : 1
            };
        },

        statusSelesai: function() {
            return {
                SELESAI_INIT : 0,
                SELESAI_DONE : 1
            };
        },

        renderTglSurat: function(value, record) {
            var tpl = new Ext.XTemplate([
            '<div class="cell-text">'+
            '<div class="subtext">'+
            '<span class="badge badge-solid margin-right-4">'+
            '<i class="icon ion-md-calendar"></i>'+
            '</span>{tgl_surat}'+
            '</div>'+
            '</div>']),
            tgl = Ext.util.Format.date(value, 'd M Y');

            if (value){
                return tpl.apply({
                    tgl_surat: tgl
                });
            } else {
                return '<span class="alternative">-</span>';
            }
        },

        renderStatusDistribusi: function(val, record) {
            this.modelDefault = this.modelDefault || this.create({});
            var records = this.modelDefault,
                tgl_distribusi = "Pada "+Ext.util.Format.date(record.get('surat_distribusi_tgl'), 'd M Y H:i'),
                ismusnah = record.get('surat_ismusnah'),
                tgl_musnah = "Pada "+Ext.util.Format.date(record.get('surat_musnah_tgl'), 'd M Y H:i'),
                isarsip = record.get('surat_isarsip'),
                tgl_arsip = "Pada "+Ext.util.Format.date(record.get('surat_arsip_tgl'), 'd M Y H:i'),
                distribusi_iscabut = record.get('surat_distribusi_iscabut'),
                tgl_distribusi_cabut = "Pada "+Ext.util.Format.date(record.get('surat_distribusi_cabut_tgl'), 'd M Y H:i'),
                tpl = new Ext.Template([
                '<div class="cell-text">',
                '<div class="subtext {color}">',
                '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
                '{title}',
                '</div>',
                '<div class="supporttext supporttext-dark">{sub}</div>',
                '</div>'
                ]);

            if (ismusnah) {
                return tpl.apply({
                    title: 'Dimusnahkan',
                    color: 'danger',
                    iconCls: 'icon ion-md-filing danger',
                    sub: tgl_musnah
                });
            } else if (isarsip) {
                return tpl.apply({
                    title: 'Diarsipkan',
                    color: 'danger',
                    iconCls: 'icon ion-md-filing danger',
                    sub: tgl_arsip
                });
            } else {
                switch(val){
                    default:
                    case records.self.statusDistribusi().DISTRIBUSI_INIT:
                    return tpl.apply({
                        title: 'Draft',
                        color: 'alternative',
                        iconCls: 'icon ion-md-create grey-600'
                    });
                    case records.self.statusDistribusi().DISTRIBUSI_DISTRIBUTE:
                    if(distribusi_iscabut){
                        return tpl.apply({
                            title: 'Belum Didistribusikan',
                            color: 'warning',
                            iconCls: 'icon ion-md-warning warning',
                        });
                    }else{
                        return tpl.apply({
                            title: 'Didistribusikan',
                            color: 'info',
                            iconCls: 'icon ion-md-send info',
                            sub: tgl_distribusi
                        });
                    }
                }
            }
        },

        renderEkspedisiTree: function(record, show_rahasia) {
            if(record.isRoot()){
                if(record.firstChild){
                    if(record.isRoot()){
                        if(record.firstChild){
                            record.set('iconCls','x-tree-icon-noicon');
                            //         var isSelesai = (record.firstChild.data.children[0].disposisi_masuk_record.surat_isselesai == "1")? '(Proses surat selesai)':'(Surat belum selesai)';
                            var isSelesai = '',
                                rec = record.firstChild.data.children[0].disposisi_masuk_record,
                                jabatan = rec.surat_properti_pembuat_jabatan_nama ? rec.surat_properti_pembuat_jabatan_nama : '(Tidak ada jabatan)',
                                unit = rec.surat_properti_pembuat_unit_nama ? rec.surat_properti_pembuat_unit_nama : '(Tidak ada unit)';
                            return (new Ext.Template([
                            "<div class='titletext'>Pada {surat_properti_buat_tgl:date('d M Y H:i')}, Surat Dibuat Oleh :</div>"+
                            "<div class='cell-row'><div class='cell-visual cell-visual-left'><img class='img img-circle img-32' src='server.php/sipas/staf/get_image/foto?id={surat_properti_pembuat_id}'></div>"+
                            "<div class='cell-text'><div class='subtext'>{surat_properti_pembuat_nama}</div><div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+" "+isSelesai+"</div></div></div>"
                            ])).apply(record.firstChild.data.children[0].disposisi_masuk_record);
                        }
                    }

                    if(record.isDisposisi()){
                        record.set('iconCls','x-tree-icon-noicon');
                        var disposisiRecord = record.get('disposisi_record'),
                            disposisiCabut = disposisiRecord.disposisi_iscabut,
                            pengirim_id = disposisiRecord.disposisi_pengirim_id,
                            pengirim_nama = disposisiRecord.disposisi_pengirim_nama,
                            jabatan = disposisiRecord.disposisi_pengirim_jabatan_nama ? disposisiRecord.disposisi_pengirim_jabatan_nama : '(Tidak ada jabatan)',
                            unit = disposisiRecord.disposisi_pengirim_unit_nama ? disposisiRecord.disposisi_pengirim_unit_nama : '(Tidak ada unit)',
                            pelaku_id = disposisiRecord.disposisi_pelaku_id,
                            pelaku_nama = disposisiRecord.disposisi_pelaku_nama,
                            isdisposisi = disposisiRecord.disposisi_induk,
                            isnotadinas = disposisiRecord.disposisi_model_sub,
                            rahasia = disposisiRecord.disposisi_israhasia,
                            perintah = disposisiRecord.perintah_nama ? disposisiRecord.perintah_nama : '(Tidak ada arahan)',
                            pesan = disposisiRecord.disposisi_pesan ? disposisiRecord.disposisi_pesan : '(Tidak ada uraian)',
                            disposisi_perintah = perintah,
                            disposisi_pesan = pesan,
                            aksi_tgl = disposisiRecord.disposisi_masuk_aksi_tgl,
                            aksi_tgl_display = Ext.util.Format.date(aksi_tgl, 'd M Y H:i'),
                            tpl_via_moniroting = '',
                            statusDistribusiCabut = null;

                        if (pengirim_id != pelaku_id){
                            tpl_via_moniroting = '<div class="onexpand-show supporttext supporttext-dark">Via asistensi oleh <span class="bold">'+pelaku_nama+'</span></div>';
                        }

                        if(isdisposisi){
                            if(perintah && rahasia == "0") perintah = 'dengan arahan '+perintah;
                            else perintah = '';

                            if (perintah == '' && rahasia == "0"|| perintah == null && rahasia == "0"){
                                disposisi_perintah = '(Tidak ada arahan)';
                            }

                            if (pesan == '' && rahasia == "0"|| pesan == null && rahasia == "0"){
                                disposisi_pesan = '(Tidak ada uraian)';
                            }

                            if (pesan == '' || pesan == null){
                                disposisi_pesan = '(Tidak ada uraian)';
                            }

                            if (rahasia == '1'){
                                if (show_rahasia){
                                    rahasia = '<span class="margin-right-4 danger">'+
                                    '<span class="badge badge-solid margin-right-4">'+
                                    '<i class="icon ion-md-lock"></i>'+
                                    '</span><span>Bersifat rahasia</span>'+
                                    '</span>';
                                    if(isnotadinas == "1"){
                                        return (new Ext.Template([
                                        "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                                        "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                        "</div>"
                                        ])).apply(disposisiRecord);
                                    }else{
                                        return (new Ext.Template([
                                        "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                                        "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                        "</div>"
                                        ])).apply(disposisiRecord);
                                    }
                                } else {
                                    rahasia = '<span class="margin-right-4 danger">'+
                                    '<span class="badge badge-solid margin-right-4">'+
                                    '<i class="icon ion-md-lock"></i>'+
                                    '</span><span>Bersifat rahasia</span>'+
                                    '</span>';
                                    if(isnotadinas == "1"){
                                        return (new Ext.Template([
                                        "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                                        "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                        "</div>"
                                        ])).apply(disposisiRecord);
                                    }else{
                                        return (new Ext.Template([
                                        "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                                        "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                        "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                        "</div>"
                                        ])).apply(disposisiRecord);
                                    }
                                }
                            }else {
                                if(isnotadinas == "1"){
                                    return (new Ext.Template([
                                    "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                                    "<span class='onexpand-hide alternative smaller-0-75'>pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                    "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</div>"+
                                    "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                    "</div>"
                                    ])).apply(disposisiRecord);
                                }else{
                                    return (new Ext.Template([
                                    "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                                    "<span class='onexpand-hide alternative smaller-0-75'>pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                    "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</div>"+
                                    "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                    "</div>"
                                    ])).apply(disposisiRecord);
                                }
                            }
                        } else{
                            if(disposisiCabut == '1') statusDistribusiCabut = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-document red-500-i'></i></span><span class='danger'>Distribusi telah dibatalkan pada {disposisi_masuk_cabut_tgl:date('d M Y H:i')}</span></span>";
                            else statusDistribusiCabut = "";

                            return (new Ext.Template([
                            "<div class='titletext'>Pada {disposisi_tgl:date('d M Y H:i')}, Didistribusikan Oleh :</div>"+
                            "<div class='cell-row'><div class='cell-visual cell-visual-left'><img class='img img-circle img-32' src='server.php/sipas/staf/get_image/foto?id={disposisi_pengirim_id}'></div>"+
                            "<div class='cell-text'><div class='subtext'>"+pengirim_nama+"</div><div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div></div></div>"+
                            "<div class='supporttext supporttext-dark margin-top-4'>"+statusDistribusiCabut+"</div></div></div>"
                            ])).apply(disposisiRecord);
                        }
                    }

                    if(record.isDisposisiMasuk()){
                        record.set('iconCls','x-tree-icon-noicon');
                        var disposisiPenerimaRecord = record.get('disposisi_masuk_record'),
                            isdisposisi = disposisiPenerimaRecord.disposisi_induk,
                            rahasia = disposisiPenerimaRecord.disposisi_israhasia,
                            penerimaBaca = disposisiPenerimaRecord.disposisi_masuk_isbaca,
                            penerimaForward = disposisiPenerimaRecord.disposisi_masuk_isterus,
                            penerimaTembusan = disposisiPenerimaRecord.disposisi_masuk_istembusan,
                            penerimaCabut = disposisiPenerimaRecord.disposisi_masuk_iscabut,
                            penerimaBerkas = disposisiPenerimaRecord.disposisi_masuk_isberkas,
                            tindakan = disposisiPenerimaRecord.disposisi_masuk_aksi,
                            tindakanNama = disposisiPenerimaRecord.aksi_nama,
                            tindakanUraian = disposisiPenerimaRecord.disposisi_masuk_pesan ? disposisiPenerimaRecord.disposisi_masuk_pesan : '',
                            penerimaBerkasTerima = disposisiPenerimaRecord.disposisi_masuk_isberkasterima,
                            aksi_tgl = disposisiPenerimaRecord.disposisi_masuk_aksi_tgl,
                            aksi_tgl_display = Ext.util.Format.date(aksi_tgl, 'd M Y H:i'),
                            jabatan = disposisiPenerimaRecord.disposisi_masuk_penerima_jabatan_nama ? disposisiPenerimaRecord.disposisi_masuk_penerima_jabatan_nama : '(Tidak ada jabatan)',
                            unit = disposisiPenerimaRecord.disposisi_masuk_penerima_unit_nama ? disposisiPenerimaRecord.disposisi_masuk_penerima_unit_nama : '(Tidak ada unit)',
                            statusBaca = null,
                            statusTindakan = null,
                            statusUraian = null,
                            statusForward = null,
                            statusCabut = null,
                            tembusan = null,
                            berkas = null,
                            berkasTerima = null;

                        //status baca
                        if(penerimaBaca == '1') statusBaca = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-mail-open blue-500-i'></i></span><span>Dibaca pada {disposisi_masuk_baca_tgl:date('d M Y H:i')}</span></span>";
                        else statusBaca = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-mail'></i></span><span>Belum dibaca</span></span>";

                        //tindakan
                        if(tindakan){
                            statusTindakan = "<span class='margin-right-8'>"+
                            "<span class='badge badge-solid margin-right-4'>"+
                            "<i class='icon ion-md-create'></i>"+
                            "</span>Diberi respon pada "+aksi_tgl_display+
                            "</span>"+
                            "<span class='margin-right-8'>"+
                            "<span class='badge badge-solid margin-right-4'>"+
                            "<i class='icon ion-md-text'></i>"+
                            "</span>"+tindakanNama+", "+tindakanUraian+
                            "</span>";
                        }
                        else {
                            statusTindakan = '';
                        }

                        //tembusan
                        if(penerimaTembusan == '1') tembusan = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-people'></i></span><span>Tembusan</span></span>";
                        else tembusan = '';

                        //berkas
                        if(penerimaBerkas == '1') berkas = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-copy'></i></span><span>Berkas belum diterima</span></span>";
                        else berkas = "";

                        if(penerimaBerkasTerima == '1') berkas = "<span class='margin-right-8 info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-copy green-700-i'></i></span><span>Berkas diterima pada {disposisi_masuk_berkasterima_tgl:date('d M Y H:i')}</span></span>";

                        //status forward
                        // if(penerimaForward == '1') statusForward = "<span class='margin-right-8 onexpand-hide info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-send green-500-i'></i></span><span>Disposisi terakhir pada {disposisi_masuk_terus_tgl:date('d M Y H:i')}</span></span>";
                        // else statusForward = "";
                        if(penerimaForward == '1') statusForward = "<span class='margin-right-8 info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-send green-500-i'></i></span><span>Disposisi terakhir pada {disposisi_masuk_terus_tgl:date('d M Y H:i')}</span></span>";
                        else statusForward = "";

                        if(penerimaCabut == '1') statusCabut = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-document red-500-i'></i></span><span class='danger'>Disposisi ini telah direvisi</span></span>";
                        else statusCabut = "";

                        if (rahasia == '1'){
                            if (show_rahasia){
                                if(tindakan){
                                    statusTindakan = "<span class='margin-right-8'>"+
                                    "<span class='badge badge-solid margin-right-4'>"+
                                    "<i class='icon ion-md-create'></i>"+
                                    "</span>Diberi respon pada "+aksi_tgl_display+
                                    "</span>"+
                                    "<span class='margin-right-8'>"+
                                    "<span class='badge badge-solid margin-right-4'>"+
                                    "<i class='icon ion-md-text'></i>"+
                                    "</span>"+tindakanNama+", "+tindakanUraian+
                                    "</span>";
                                } else {
                                    statusTindakan = '';
                                }
                            } else {
                                if(tindakan){
                                    statusTindakan = "<span class='margin-right-8'>"+
                                    "<span class='badge badge-solid margin-right-4'>"+
                                    "<i class='icon ion-md-create'></i>"+
                                    "</span>Diberi respon pada "+aksi_tgl_display+
                                    "</span>";
                                } else {
                                    statusTindakan = '';
                                }
                            }
                        }

                        if(isdisposisi){
                            return (new Ext.Template([
                            "<div class='cell-row'><div class='cell-visual'><img src='server.php/sipas/staf/get_image/foto?id={disposisi_masuk_penerima_id}' class='img img-32 img-circle'></div>"+
                            "<div class='cell-text'>"+
                            "<div class='subtext'>{disposisi_masuk_penerima_nama}</div>"+
                            "<div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div>"+
                            "<div class='supporttext supporttext-dark margin-top-4'>"+
                            statusBaca+" "+tembusan+" "+berkas+" <div>"+statusForward+"</div><div>"+statusTindakan+"</div>"+statusCabut+
                            "</div>"+
                            "</div></div>"
                            ])).apply(disposisiPenerimaRecord);
                        }else{
                            return (new Ext.Template([
                            "<div class='cell-row'><div class='cell-visual'><img src='server.php/sipas/staf/get_image/foto?id={disposisi_masuk_penerima_id}' class='img img-32 img-circle'></div>"+
                            "<div class='cell-text'>"+
                            "<div class='subtext'>{disposisi_masuk_penerima_nama}</div>"+
                            "<div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div>"+
                            "<div class='supporttext supporttext-dark margin-top-4'>"+
                            statusBaca+" "+tembusan+" "+berkas+" <div>"+statusForward+"</div><div>"+statusTindakan+"</div>"+statusCabut+
                            "</div>"+
                            "</div></div>"
                            ])).apply(disposisiPenerimaRecord);
                        }
                    }
                    record.set('iconCls','x-tree-icon-noicon');
                    //         var isSelesai = (record.firstChild.data.children[0].disposisi_masuk_record.surat_isselesai == "1")? '(Proses surat selesai)':'(Surat belum selesai)';
                    var isSelesai = '';
                    return (new Ext.Template([
                    "<div class='titletext'>Pada {surat_properti_buat_tgl:date('d M Y H:i')}, Surat Dibuat Oleh :</div>"+
                    "<div class='cell-row'><div class='cell-visual cell-visual-left'><img class='img img-circle img-32' src='server.php/sipas/staf/get_image/foto?id={surat_properti_pembuat_id}'></div>"+
                    "<div class='cell-text'><div class='subtext'>{surat_properti_pembuat_nama}</div><div class='supporttext supporttext-dark'>{surat_properti_pembuat_jabatan_nama} - {surat_properti_pembuat_unit_nama} "+isSelesai+"</div></div></div>"
                    ])).apply(record.firstChild.data.children[0].disposisi_masuk_record);
                }
            }

            if(record.isDisposisi()){
                record.set('iconCls','x-tree-icon-noicon');
                var disposisiRecord = record.get('disposisi_record'),
                    pengirim_id = disposisiRecord.disposisi_pengirim_id,
                    pengirim_nama = disposisiRecord.disposisi_pengirim_nama,
                    jabatan = disposisiRecord.disposisi_pengirim_jabatan_nama ? disposisiRecord.disposisi_pengirim_jabatan_nama : '(Tidak ada jabatan)',
                    unit = disposisiRecord.disposisi_pengirim_unit_nama ? disposisiRecord.disposisi_pengirim_unit_nama : '(Tidak ada unit)',
                    pelaku_id = disposisiRecord.disposisi_pelaku_id,
                    pelaku_nama = disposisiRecord.disposisi_pelaku_nama,
                    isdisposisi = disposisiRecord.disposisi_induk,
                    isnotadinas = disposisiRecord.disposisi_model_sub,
                    rahasia = disposisiRecord.disposisi_israhasia,
                    perintah = disposisiRecord.perintah_nama ? disposisiRecord.perintah_nama : '(Tidak ada arahan)',
                    pesan = disposisiRecord.disposisi_pesan ? disposisiRecord.disposisi_pesan : '(Tidak ada uraian)',
                    disposisi_perintah = perintah,
                    disposisi_pesan = pesan,
                    aksi_tgl = disposisiRecord.disposisi_masuk_aksi_tgl,
                    aksi_tgl_display = Ext.util.Format.date(aksi_tgl, 'd M Y H:i'),
                    tpl_via_moniroting = '';

                if (pengirim_id != pelaku_id){
                    tpl_via_moniroting = '<div class="onexpand-show supporttext supporttext-dark">Via asistensi oleh <span class="bold">'+pelaku_nama+'</span></div>';
                }

                if(isdisposisi){
                    if(perintah && rahasia == "0") perintah = 'dengan arahan '+perintah;
                    else perintah = '';

                    if (perintah == '' && rahasia == "0"|| perintah == null && rahasia == "0"){
                        disposisi_perintah = '(Tidak ada arahan)';
                    }

                    if (pesan == '' && rahasia == "0"|| pesan == null && rahasia == "0"){
                        disposisi_pesan = '';
                    }

                    if (rahasia == '1'){
                        if (show_rahasia){
                            rahasia = '<span class="margin-right-4 danger">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-lock"></i>'+
                            '</span><span>Bersifat rahasia</span>'+
                            '</span>';
                            if(isnotadinas == "1"){
                                return (new Ext.Template([
                                "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                                "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                "</div>"
                                ])).apply(disposisiRecord);
                            }else{
                                return (new Ext.Template([
                                "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                                "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                                "</div>"
                                ])).apply(disposisiRecord);
                            }
                        } else {
                            rahasia = '<span class="margin-right-4 danger">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-lock"></i>'+
                            '</span><span>Bersifat rahasia</span>'+
                            '</span>';
                            if(isnotadinas == "1"){
                                return (new Ext.Template([
                                "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                                "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                "</div>"
                                ])).apply(disposisiRecord);
                            }else{
                                return (new Ext.Template([
                                "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                                "<span class='onexpand-hide alternative smaller-0-75'>"+rahasia+" pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                                "<div class='onexpand-show supporttext supporttext-dark'><span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</span>"+rahasia+"</div>"+
                                "</div>"
                                ])).apply(disposisiRecord);
                            }
                        }
                    } else {
                        if(isnotadinas == "1"){
                            return (new Ext.Template([
                            "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Nota Dinas</span>"+
                            "<span class='onexpand-hide alternative smaller-0-75'>pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                            "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</div>"+
                            "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                            "</div>"
                            ])).apply(disposisiRecord);
                        }else{
                            return (new Ext.Template([
                            "<div class='cell-text'><div class='subtext'><span class='bold margin-right-4'>Mengirim Disposisi</span>"+
                            "<span class='onexpand-hide alternative smaller-0-75'>pada {disposisi_tgl:date('d M Y H:i')}</span></div>"+
                            "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-calendar'></i></span>{disposisi_tgl:date('d M Y H:i')}</div>"+
                            "<div class='onexpand-show supporttext supporttext-dark'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-quote'></i></span>"+disposisi_perintah+", "+disposisi_pesan+"</div>"+tpl_via_moniroting+
                            "</div>"
                            ])).apply(disposisiRecord);
                        }
                    }
                } else{
                    return (new Ext.Template([
                    "<div class='titletext'>Pada {disposisi_tgl:date('d M Y H:i')}, Didistribusikan Oleh :</div>"+
                    "<div class='cell-row'><div class='cell-visual cell-visual-left'><img class='img img-circle img-32' src='server.php/sipas/staf/get_image/foto?id={disposisi_pengirim_id}'></div>"+
                    "<div class='cell-text'><div class='subtext'>"+pengirim_nama+"</div><div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div></div></div>"
                    ])).apply(disposisiRecord);
                }
            }

            if(record.isDisposisiMasuk()){
                record.set('iconCls','x-tree-icon-noicon');
                var disposisiPenerimaRecord = record.get('disposisi_masuk_record'),
                    isdisposisi = disposisiPenerimaRecord.disposisi_induk,
                    rahasia = disposisiPenerimaRecord.disposisi_israhasia,
                    penerimaBaca = disposisiPenerimaRecord.disposisi_masuk_isbaca,
                    penerimaForward = disposisiPenerimaRecord.disposisi_masuk_isterus,
                    penerimaTembusan = disposisiPenerimaRecord.disposisi_masuk_istembusan,
                    penerimaCabut = disposisiPenerimaRecord.disposisi_masuk_iscabut,
                    penerimaBerkas = disposisiPenerimaRecord.disposisi_masuk_isberkas,
                    tindakan = disposisiPenerimaRecord.disposisi_masuk_aksi,
                    tindakanNama = disposisiPenerimaRecord.aksi_nama,
                    tindakanUraian = disposisiPenerimaRecord.disposisi_masuk_pesan ? disposisiPenerimaRecord.disposisi_masuk_pesan : '',
                    penerimaBerkasTerima = disposisiPenerimaRecord.disposisi_masuk_isberkasterima,
                    aksi_tgl = disposisiPenerimaRecord.disposisi_masuk_aksi_tgl,
                    aksi_tgl_display = Ext.util.Format.date(aksi_tgl, 'd M Y H:i'),
                    jabatan = disposisiPenerimaRecord.disposisi_masuk_penerima_jabatan_nama ? disposisiPenerimaRecord.disposisi_masuk_penerima_jabatan_nama : '(Tidak ada jabatan)',
                    unit = disposisiPenerimaRecord.disposisi_masuk_penerima_unit_nama ? disposisiPenerimaRecord.disposisi_masuk_penerima_unit_nama : '(Tidak ada unit)',
                    statusBaca = null,
                    statusTindakan = null,
                    statusUraian = null,
                    statusForward = null,
                    statusCabut = null,
                    tembusan = null,
                    berkas = null,
                    berkasTerima = null;

                //status baca
                if(penerimaBaca == '1') statusBaca = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-mail-open blue-500-i'></i></span><span>Dibaca pada {disposisi_masuk_baca_tgl:date('d M Y H:i')}</span></span>";
                else statusBaca = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-mail'></i></span><span>Belum dibaca</span></span>";

                //tindakan
                if(tindakan){
                    statusTindakan = "<span class='margin-right-8'>"+
                    "<span class='badge badge-solid margin-right-4'>"+
                    "<i class='icon ion-md-create'></i>"+
                    "</span>Diberi respon pada "+aksi_tgl_display+
                    "</span>"+
                    "<span class='margin-right-8'>"+
                    "<span class='badge badge-solid margin-right-4'>"+
                    "<i class='icon ion-md-text'></i>"+
                    "</span>"+tindakanNama+", "+tindakanUraian+
                    "</span>";
                }else {
                    statusTindakan = '';
                }

                //tembusan
                if(penerimaTembusan == '1') tembusan = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-people'></i></span><span>Tembusan</span></span>";
                else tembusan = '';

                //berkas
                if(penerimaBerkas == '1') berkas = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-copy'></i></span><span>Berkas belum diterima</span></span>";
                else berkas = "";

                if(penerimaBerkasTerima == '1') berkas = "<span class='margin-right-8 info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-copy green-700-i'></i></span><span>Berkas diterima pada {disposisi_masuk_berkasterima_tgl:date('d M Y H:i')}</span></span>";

                //status forward
                // if(penerimaForward == '1') statusForward = "<span class='margin-right-8 onexpand-hide info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-send green-500-i'></i></span><span>Disposisi terakhir pada {disposisi_masuk_terus_tgl:date('d M Y H:i')}</span></span>";
                // else statusForward = "";
                if(penerimaForward == '1') statusForward = "<span class='margin-right-8 info'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-send green-500-i'></i></span><span>Disposisi terakhir pada {disposisi_masuk_terus_tgl:date('d M Y H:i')}</span></span>";
                else statusForward = "";

                if(penerimaCabut == '1') statusCabut = "<span class='margin-right-8'><span class='badge badge-solid margin-right-4'><i class='icon ion-md-document red-500-i'></i></span><span class='danger'>Distribusi telah dibatalkan pada {disposisi_masuk_cabut_tgl:date('d M Y H:i')}</span></span>";
                else statusCabut = "";

                if (rahasia == '1'){
                    if (show_rahasia){
                        if(tindakan){
                            statusTindakan = "<span class='margin-right-8'>"+
                            "<span class='badge badge-solid margin-right-4'>"+
                            "<i class='icon ion-md-create'></i>"+
                            "</span>Diberi respon pada "+aksi_tgl_display+
                            "</span>"+
                            "<span class='margin-right-8'>"+
                            "<span class='badge badge-solid margin-right-4'>"+
                            "<i class='icon ion-md-text'></i>"+
                            "</span>"+tindakanNama+", "+tindakanUraian+
                            "</span>";
                        }
                        else {
                            statusTindakan = '';
                        }
                    } else {
                        if(tindakan){
                            statusTindakan = "<span class='margin-right-8'>"+
                            "<span class='badge badge-solid margin-right-4'>"+
                            "<i class='icon ion-md-create'></i>"+
                            "</span>Diberi respon pada "+aksi_tgl_display+
                            "</span>";
                        } else {
                            statusTindakan = '';
                        }
                    }
                }

                if(isdisposisi){
                    return (new Ext.Template([
                    "<div class='cell-row'><div class='cell-visual'><img src='server.php/sipas/staf/get_image/foto?id={disposisi_masuk_penerima_id}' class='img img-32 img-circle'></div>"+
                    "<div class='cell-text'>"+
                    "<div class='subtext'>{disposisi_masuk_penerima_nama}</div>"+
                    "<div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div>"+
                    "<div class='supporttext supporttext-dark margin-top-4'>"+
                    statusBaca+" "+tembusan+" "+berkas+" <div>"+statusForward+"</div><div>"+statusTindakan+"</div>"+statusCabut+
                    "</div>"+
                    "</div></div>"
                    ])).apply(disposisiPenerimaRecord);
                }else{
                    if(disposisiPenerimaRecord.disposisi_masuk_staf){
                        return (new Ext.Template([
                        "<div class='cell-row'><div class='cell-visual'><img src='server.php/sipas/staf/get_image/foto?id={disposisi_masuk_penerima_id}' class='img img-32 img-circle'></div>"+
                        "<div class='cell-text'>"+
                        "<div class='subtext'>{disposisi_masuk_penerima_nama}</div>"+
                        "<div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div>"+
                        "<div class='supporttext supporttext-dark margin-top-4'>"+
                        statusBaca+" "+tembusan+" "+berkas+" <div>"+statusForward+"</div><div>"+statusTindakan+"</div>"+statusCabut+
                        "</div>"+
                        "</div></div>"
                        ])).apply(disposisiPenerimaRecord);
                    }else{
                        return (new Ext.Template([
                        "<div class='cell-row'><div class='cell-visual'><div class='img img-circle img-32'><i class='bigger-1-25 icon ion-md-ribbon grey-600-i'></i></div></div>"+
                        "<div class='cell-text'>"+
                        "<div class='subtext'>{jabatan_penerima_nama}</div>"+
                        // "<div class='supporttext supporttext-dark'>"+jabatan+" - "+unit+"</div>"+
                        "<div class='supporttext supporttext-dark margin-top-4'>"+
                        statusBaca+" "+tembusan+" "+berkas+" <div>"+statusForward+"</div><div>"+statusTindakan+"</div>"+statusCabut+
                        "</div>"+
                        "</div></div>"
                        ])).apply(disposisiPenerimaRecord);
                    }
                }
            }
        },

        renderStatusDistribusiInternal: function(val, record) {
            this.modelDefault = this.modelDefault || this.create({});
            var records = this.modelDefault,
                setuju = record.get('surat_setuju'),
                tgl_distribusi = "Pada "+Ext.util.Format.date(record.get('surat_distribusi_tgl'), 'd M Y H:i'),
                tgl_setuju = "Pada "+Ext.util.Format.date(record.get('surat_setuju_tgl'), 'd M Y H:i'),
                musnah = record.get('surat_ismusnah'),
                tgl_musnah = "Pada "+Ext.util.Format.date(record.get('surat_musnah_tgl'), 'd M Y H:i'),
                isarsip = record.get('surat_isarsip'),
                tgl_arsip = "Pada "+Ext.util.Format.date(record.get('surat_arsip_tgl'), 'd M Y H:i'),
                surat_distribusi_iscabut = record.get('surat_distribusi_iscabut'),
                tgl_distribusi_cabut = "Pada "+Ext.util.Format.date(record.get('surat_distribusi_cabut_tgl'), 'd M Y H:i'),
                tpl = new Ext.Template([
                '<div class="cell-text">',
                '<div class="subtext {color}">',
                '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
                '{title}',
                '</div>',
                '<div class="supporttext supporttext-dark">{sub}</div>',
                '</div>'
                ]);

            if(musnah){
                return tpl.apply({
                    title: 'Dimusnahkan',
                    color: 'danger',
                    iconCls: 'icon ion-md-filing danger',
                    sub: tgl_musnah
                });
            }else if(isarsip){
                return tpl.apply({
                    title: 'Diarsipkan',
                    color: 'danger',
                    iconCls: 'icon ion-md-filing danger',
                    sub: tgl_arsip
                });
            }else if(setuju === 2){
                switch(val){
                    default:
                    case records.self.statusDistribusi().DISTRIBUSI_INIT:
                    return tpl.apply({
                        title: 'Belum Didistribusikan',
                        color: 'warning',
                        iconCls: 'icon ion-md-warning warning'
                    });
                    case records.self.statusDistribusi().DISTRIBUSI_DISTRIBUTE:
                    if(surat_distribusi_iscabut){
                        return tpl.apply({
                            title: 'Belum Didistribusikan',
                            color: 'warning',
                            iconCls: 'icon ion-md-warning warning'
                        });
                    }else{
                        return tpl.apply({
                            title: 'Didistribusikan',
                            color: 'info',
                            iconCls: 'icon ion-md-send info',
                            sub: tgl_distribusi
                        });
                    }
                }
            }else if(setuju === 1){
                switch(val){
                    default:
                    case records.self.statusDistribusi().DISTRIBUSI_INIT:
                    return tpl.apply({
                        title: 'Draft',
                        color: 'alternative',
                        iconCls: 'icon ion-md-create grey-600'
                    });
                    case records.self.statusDistribusi().DISTRIBUSI_DISTRIBUTE:
                    if(surat_distribusi_iscabut){
                        return tpl.apply({
                            title: 'Belum Didistribusikan',
                            color: 'warning',
                            iconCls: 'icon ion-md-warning warning'
                        });
                    }else{
                        return tpl.apply({
                            title: 'Didistribusikan',
                            color: 'info',
                            iconCls: 'icon ion-md-send info',
                            sub: tgl_distribusi
                        });
                    }
                }
            }else{
                switch(setuju){
                    default:
                    case record.self.statusPenyetujuan().PERSETUJUAN_INIT:
                    return tpl.apply({
                        title: 'Pending',
                        color: 'warning',
                        iconCls: 'icon ion-md-warning warning'
                    });
                    case record.self.statusPenyetujuan().PERSETUJUAN_DECLINE:
                    return tpl.apply({
                        title: 'Tolak',
                        color: 'danger',
                        iconCls: 'icon ion-md-close danger',
                        sub: tgl_setuju
                    });
                }
            }
        },

        renderStatusPenyetujuan: function(val, records, supporttext) {
            this.modelDefault = this.modelDefault || this.create({});
            var record = this.modelDefault,
                setuju = records.get('surat_setuju_setuju'),
                total = records.get('surat_setuju_total'),
                model = records.get('surat_model'),
                model_sub = records.get('surat_model_sub'),
                setuju_petikan = records.get('surat_petikan_setuju'),

                tpl = new Ext.Template([
                '<div class="cell-text">',
                '<div class="subtext {color}">',
                '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
                '{title}',
                '</div>',
                '<div class="supporttext supporttext-dark">{sub}</div>',
                '</div>'
                ]);

            var setuju_tgl = Ext.util.Format.date(records.get('surat_setuju_tgl'), 'd M Y H:i'),
                subtext = "Pada "+setuju_tgl,
                ekspedisi = records.get('ekspedisi_nama'),
                ekspedisi_tgl = records.get('surat_ekspedisi_tgl'),
                batal = records.get('surat_nomor_isbatal'),
                batal_tgl = records.get('surat_nomor_batal_tgl'),
                musnah = records.get('surat_ismusnah'),
                musnah_tgl = records.get('surat_musnah_tgl'),
                isarsip = records.get('surat_isarsip'),
                arsip_tgl = records.get('surat_arsip_tgl'),
                isdistribusi = records.get('surat_isdistribusi'),
                tpl_pending = '',
                tpl_setuju = '',
                tpl_tolak = '',
                tpl_petikan_pending = '',
                tpl_petikan_setuju = '',
                tpl_petikan_tolak = '',
                tpl_salin = '',
                total_penyetuju = records.get('surat_setuju_total'),
                jumlah_pending = records.get('surat_setuju_pending'),
                jumlah_setuju = records.get('surat_setuju_setuju'),
                jumlah_tolak = records.get('surat_setuju_tolak'),
                total_petikan_penyetuju = records.get('surat_petikan_setuju_total'),
                jumlah_petikan_pending = records.get('surat_petikan_setuju_pending'),
                jumlah_petikan_setuju = records.get('surat_petikan_setuju_setuju'),
                jumlah_petikan_tolak = records.get('surat_petikan_setuju_tolak');
            if (!supporttext){
                supporttext = '';
            }

            if (musnah){
                return new Ext.XTemplate(['<div class="cell-text">',
                '<div class="subtext danger">',
                '<span class="badge badge-solid margin-right-4">',
                '<i class="icon ion-md-filing danger"></i>',
                '</span> {word}',
                '</div>',
                '<div class="supporttext supporttext-dark">{tgl}</div>',
                '</div>']).apply({
                    word: 'Surat Dimusnahkan',
                    tgl: 'Pada '+Ext.util.Format.date(musnah_tgl, 'd M Y H:i')
                });
            } else if (isarsip){
                return new Ext.XTemplate(['<div class="cell-text">',
                '<div class="subtext danger">',
                '<span class="badge badge-solid margin-right-4">',
                '<i class="icon ion-md-filing danger"></i>',
                '</span> {word}',
                '</div>',
                '<div class="supporttext supporttext-dark">{tgl}</div>',
                '</div>']).apply({
                    word: 'Surat Diarsipkan',
                    tgl: 'Pada '+Ext.util.Format.date(arsip_tgl, 'd M Y H:i')
                });
            } else if (batal){
                return new Ext.XTemplate(['<div class="cell-text">',
                '<div class="subtext danger">',
                '<span class="badge badge-solid margin-right-4">',
                '<i class="icon ion-md-close danger"></i>',
                '</span> {word}',
                '</div>',
                '<div class="supporttext supporttext-dark">{tgl}</div>',
                '</div>']).apply({
                    word: 'Surat Dibatalkan',
                    tgl: 'Pada '+Ext.util.Format.date(batal_tgl, 'd M Y H:i')
                });
            } else {
                switch(parseInt(val)){
                    default:
                    case record.self.statusPenyetujuan().PERSETUJUAN_INIT:
                    return tpl.apply({
                        title: 'Draft',
                        color: 'alternative',
                        iconCls: 'icon ion-md-create alternative',
                        sub: ''
                    });

                    case record.self.statusPenyetujuan().PERSETUJUAN_PROCESS:
                    //         return tpl.apply({
                    //             title: setuju+'/'+total+' menyetujui',
                    //             color: 'alternative',
                    //             iconCls: 'icon ion-md-timer grey-600-i',
                    //             sub: supporttext,
                    //         });

                    if (jumlah_pending > 0){
                        tpl_pending = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-timer"></i>'+
                        '</span>'+jumlah_pending+''+
                        '</span>';
                    }
                    if (jumlah_setuju > 0){
                        tpl_setuju = '<span class="margin-right-8 green-600-i">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-checkmark info"></i>'+
                        '</span>'+jumlah_setuju+''+
                        '</span>';
                    }
                    if (jumlah_tolak > 0){
                        tpl_tolak = '<span class="margin-right-8 danger">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-close danger"></i>'+
                        '</span>'+jumlah_tolak+''+
                        '</span>';
                    }

                    return new Ext.XTemplate([
                    '<div class="cell-text">',
                    '<div class="subtext warning">',
                    '<span class="badge badge-solid margin-right-4">',
                    '<i class="icon ion-md-timer"></i>',
                    '</span>Proses penyetujuan',
                    '</div>',
                    '<div class="supporttext supporttext-dark">{pending}{setuju}{tolak}</div>',
                    '</div>'
                    ]).apply({
                        pending: tpl_pending,
                        setuju: tpl_setuju,
                        tolak: tpl_tolak
                    });

                    case record.self.statusPenyetujuan().PERSETUJUAN_APPROVE:
                    if (model == 2 && ekspedisi){
                        return new Ext.XTemplate(['<div class="cell-text">',
                        '<div class="subtext info">',
                        '<span class="badge badge-solid margin-right-4">',
                        '<i class="icon ion-md-cube info"></i>',
                        '</span> {word}',
                        '</div>',
                        '<div class="supporttext supporttext-dark">{tgl}</div>',
                        '</div>']).apply({
                            word: 'Diekspedisi',
                            tgl: 'Pada '+Ext.util.Format.date(ekspedisi_tgl, 'd M Y')
                        });
                    }else if(model == 2 && !isdistribusi){
                        return tpl.apply({
                            title: 'Belum Didistribusikan',
                            color: 'warning',
                            iconCls: 'icon ion-md-warning warning'
                        });

                    }else if (model == 6 && setuju_petikan != 2 && model_sub === 2){
                        // Proses Petikan

                        if (jumlah_petikan_pending > 0){
                            tpl_petikan_pending = '<span class="margin-right-8">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-timer"></i>'+
                            '</span>'+jumlah_petikan_pending+''+
                            '</span>';
                        }

                        if (jumlah_petikan_setuju > 0){
                            tpl_petikan_setuju = '<span class="margin-right-8 green-600-i">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-checkmark info"></i>'+
                            '</span>'+jumlah_petikan_setuju+''+
                            '</span>';
                        }

                        if (jumlah_petikan_tolak > 0){
                            tpl_petikan_tolak = '<span class="margin-right-8 danger">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-close danger"></i>'+
                            '</span>'+jumlah_petikan_tolak+''+
                            '</span>';
                        }

                        return new Ext.XTemplate([
                        '<div class="cell-text">',
                        '<div class="subtext warning">',
                        '<span class="badge badge-solid margin-right-4">',
                        '<i class="icon ion-md-timer"></i>',
                        '</span>Proses petikan',
                        '</div>',
                        '<div class="supporttext supporttext-dark">{pending}{setuju}{tolak}</div>',
                        '</div>'
                        ]).apply({
                            pending: tpl_petikan_pending,
                            setuju: tpl_petikan_setuju,
                            tolak: tpl_petikan_tolak
                        });
                    } else {
                        if(isdistribusi && model == 6) {
                            return tpl.apply({
                                title: 'Didistribusikan',
                                color: 'info',
                                iconCls: 'icon ion-md-send info',
                                sub: subtext
                            });
                        } else {
                            return tpl.apply({
                                title: 'Disetujui',
                                color: 'info',
                                iconCls: 'icon ion-md-checkmark info',
                                sub: subtext
                            });
                        }
                    }
                    case record.self.statusPenyetujuan().PERSETUJUAN_REVISION:
                    //         return tpl.apply({
                    //             title: 'Dalam Revisi',
                    //             color: 'alternative',
                    //             iconCls: 'icon ion-md-timer grey-600-i',
                    //             sub: supporttext
                    //         });
                    if (jumlah_pending > 0){
                        tpl_pending = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-timer"></i>'+
                        '</span>'+jumlah_pending+''+
                        '</span>';
                    }
                    if (jumlah_setuju > 0){
                        tpl_setuju = '<span class="margin-right-8 info">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-checkmark info"></i>'+
                        '</span>'+jumlah_setuju+''+
                        '</span>';
                    }
                    if (jumlah_tolak > 0){
                        tpl_tolak = '<span class="margin-right-8 danger">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-close danger"></i>'+
                        '</span>'+jumlah_tolak+''+
                        '</span>';
                    }

                    if (batal){
                        return new Ext.XTemplate(['<div class="cell-text">',
                        '<div class="subtext danger">',
                        '<span class="badge badge-solid margin-right-4">',
                        '<i class="icon ion-md-close danger"></i>',
                        '</span> {word}',
                        '</div>',
                        '<div class="supporttext supporttext-dark">{tgl}</div>',
                        '</div>']).apply({
                            word: 'Surat Dibatalkan',
                            tgl: 'Pada '+Ext.util.Format.date(batal_tgl, 'd M Y')
                        });
                    } else {
                        return new Ext.XTemplate([
                        '<div class="cell-text">',
                        '<div class="subtext warning">',
                        '<span class="badge badge-solid margin-right-4">',
                        '<i class="icon ion-md-timer"></i>',
                        '</span>Proses pengajuan ulang',
                        '</div>',
                        '<div class="supporttext supporttext-dark">{pending}{setuju}{tolak}</div>',
                        '</div>'
                        ]).apply({
                            pending: tpl_pending,
                            setuju: tpl_setuju,
                            tolak: tpl_tolak
                        });
                    }

                    //         return new Ext.XTemplate([
                    //             '<div class="cell-text">',
                    //                 '<div class="subtext warning">',
                    //                     '<span class="badge badge-solid margin-right-4">',
                    //                         '<i class="icon ion-md-timer"></i>',
                    //                     '</span>Proses pengajuan ulang',
                    //                 '</div>',
                    //                 '<div class="supporttext supporttext-dark">{pending}{setuju}{tolak}</div>',
                    //             '</div>'
                    //         ]).apply({
                    //             pending: tpl_pending,
                    //             setuju: tpl_setuju,
                    //             tolak: tpl_tolak
                    //         });
                    case record.self.statusPenyetujuan().PERSETUJUAN_DECLINE:
                    return tpl.apply({
                        title: 'Revisi',
                        color: 'danger',
                        iconCls: 'icon ion-md-close danger',
                        sub: subtext
                    });
                }
            }
        },

        renderStatusPenyetujuanKoreksi: function(val, records) {
            this.modelDefault = this.modelDefault || this.create({});
            var record = this.modelDefault,
                setuju = records.get('surat_setuju_setuju'),
                total = records.get('surat_setuju_total'),
                tpl = new Ext.Template([
                '<div class="subtext {color}">',
                '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
                '{title}',
                '</div>'
                ]);


            switch(parseInt(val)){
                default:
                case record.self.statusPenyetujuan().PERSETUJUAN_INIT:
                return tpl.apply({
                    title: 'Draft',
                    color: 'alternative',
                    iconCls: 'icon ion-md-create info'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_PROCESS:
                return tpl.apply({
                    title: 'Dalam Proses',
                    color: 'alternative',
                    iconCls: 'icon ion-md-timer grey-600'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_APPROVE:
                return tpl.apply({
                    title: 'Disetujui',
                    color: 'info',
                    iconCls: 'icon ion-md-checkmark info'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_REVISION:
                return tpl.apply({
                    title: 'Dalam Revisi',
                    color: 'alternative',
                    iconCls: 'icon ion-md-timer grey-600'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_DECLINE:
                return tpl.apply({
                    title: 'Revisi',
                    color: 'danger',
                    iconCls: 'icon ion-md-close danger'
                });
            }
        },

        renderStatusInternal: function(val, record) {
            this.modelDefault = this.modelDefault || this.create({});
            var record = this.modelDefault,
                tpl = new Ext.Template([
                '<div class="subtext {color}">',
                '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
                '{title}',
                '</div>'
                ]);

            switch(parseInt(val)){
                default:
                return tpl.apply({
                    title: 'Belum Terkirim',
                    color: 'warning',
                    iconCls: 'icon ion-md-warning warning'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_INIT:
                case record.self.statusPenyetujuan().PERSETUJUAN_PROCESS:
                return tpl.apply({
                    title: 'Belum Menanggapi',
                    color: 'alternative',
                    iconCls: 'icon ion-md-timer grey-600'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_APPROVE:
                return tpl.apply({
                    title: 'Diterima',
                    color: 'info',
                    iconCls: 'icon ion-md-checkmark info'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_REVISION:
                return tpl.apply({
                    title: 'Revisi',
                    color: 'warning',
                    iconCls: 'icon ion-md-warning warning'
                });
                case record.self.statusPenyetujuan().PERSETUJUAN_DECLINE:
                return tpl.apply({
                    title: 'Ditolak',
                    color: 'danger',
                    iconCls: 'icon ion-md-close danger'
                });
            }
        },

        renderStatusSelesai: function(val, record, supporttext) {
            this.modelDefault = this.modelDefault || this.create({});
            var record = this.modelDefault;
            var tpl = new Ext.Template([
            '<div style="subtext {color}">',
            '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
            '<span class="{color}">{title}</span>',
            '</div>',
            '<div class="supporttext supporttext-dark">{supporttext}</div>'
            ]);
            switch(val){
                default:
                case record.self.statusSelesai().SELESAI_INIT:
                return tpl.apply({
                    title: 'Belum Selesai',
                    color: 'warning',
                    iconCls: 'icon ion-md-warning warning',
                    supporttext: ''
                });
                case record.self.statusSelesai().SELESAI_DONE:
                return tpl.apply({
                    title: 'Proses Selesai',
                    color: 'info',
                    iconCls: 'icon ion-md-checkmark info',
                    supporttext: supporttext
                });
            }
        },

        renderBaca: function(isbaca, value, display) {
            var val = (value)? value : '<span class="alternative">(Tidak Ada '+display+')</span>';
            if(!isbaca){
                return '<span class="bold">'+val+'</span>';
            }else{
                return val;
            }
        },

        renderRetensi: function(useretensi, retensi_tgl, record) {
            if(useretensi){
                var tanggal = new Date(),
                    retensi_tgl = retensi_tgl,
                    inaktif_tgl = record.get('surat_inaktif_tgl'),
                    tanggal_display = Ext.util.Format.date(retensi_tgl, 'd M Y'),
                    inaktif_display = Ext.util.Format.date(inaktif_tgl, 'd M Y') ? Ext.util.Format.date(inaktif_tgl, 'd M Y') : '';

                if(retensi_tgl) retensi_tgl.setHours(0,0,0,0);
                if(inaktif_tgl) inaktif_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);

                var isretensi = (retensi_tgl < tanggal)? 1 : 0,
                    is_inaktif = (inaktif_tgl < tanggal)? 1 : 0;

                if(is_inaktif){
                    return '<div class="subtext alternative">Terlewat Tidak Aktif</div>'+
                    '<div class="supporttext supporttext-dark">'+inaktif_display+'</div>';
                }else if(isretensi){
                    return '<div class="subtext alternative">Tidak Aktif</div>'+
                    '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                }else{
                    var selisih = (retensi_tgl-tanggal)/1000,
                        hasil = Math.floor(selisih/(86400));
                    if(selisih === 0){
                        return '<div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Sampai Hari Ini</div>'+
                        '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                    }else{
                        var _return = '<div class="subtext alternative"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                        '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                        if (hasil <= 7){
                            _return = '<div class="subtext yellow-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                        }
                        if (hasil <=3){
                            _return = '<div class="subtext orange-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                        }
                        if (hasil === 1){
                            _return = '<div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div>';
                        }
                        return _return;
                    }
                }
            }else{
                return '<span class="alternative">-</span>';
            }
        },

        renderPrioritas: function(useprioritas, prioritas_tgl, aksi, record, isSession) {
            if(useprioritas !== null){
                var tanggal = new Date(),
                    record = record,
                    tgl_selesai = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y'),
                    now = Ext.util.Format.date(tanggal, 'd M Y'),
                    prioritas_tgl = prioritas_tgl,
                    tanggal_display = (prioritas_tgl)? Ext.util.Format.date(prioritas_tgl, 'd M Y') : null;

                if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);
                var isprioritas = (prioritas_tgl < tanggal)? 1 : 0;
                if(!isprioritas){
                    var selisih = (prioritas_tgl-tanggal)/1000,
                        hasil = Math.floor(selisih/(86400));
                    if(aksi){
                        if (isSession){
                            return '<span class="alternative">-</span>';
                        }
                        return '<div class="cell-text"><div class="subtext"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-checkmark green-600-i"></i></span><span class="info">Selesai</span>'+
                        '<div class="supporttext supporttext-dark">'+tgl_selesai+'</div></div>';
                    }else{
                        var _return = '<div class="cell-text"><div class="subtext alternative"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                        '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        if (hasil <= 7){
                            _return = '<div class="cell-text"><div class="subtext yellow-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }
                        if (hasil <= 3){
                            _return = '<div class="cell-text"><div class="subtext orange-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }
                        if (hasil === 1){
                            _return = '<div class="cell-text"><div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Kurang '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }
                        if (hasil === 0){
                            _return = '<div class="cell-text"><div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Sampai Hari Ini</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }

                        return _return;
                        //             return '<div class="subtext warning"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert amber-600-i"></i></span>Kurang '+hasil+' Hari</div>'+
                        //                 '<div class="supporttext">'+tanggal_display+'</div>';
                    }
                }else{
                    var selisih = (tanggal-prioritas_tgl)/1000,
                        hasil = Math.floor(selisih/(86400));
                    if(aksi){
                        if (isSession){
                            return '<span class="alternative">-</span>';
                        }
                        return '<div class="cell-text"><div class="subtext info"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-checkmark"></i></span>Selesai</div>'+
                        '<div class="supporttext supporttext-dark">'+tgl_selesai+'</div></div>';
                    }else{
                        if(selisih === 0){
                            return '<div class="cell-text"><div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Sampai Hari Ini</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }else{
                            return '<div class="cell-text"><div class="subtext red-700"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert"></i></span>Terlewat '+hasil+' Hari</div>'+
                            '<div class="supporttext supporttext-dark">'+tanggal_display+'</div></div>';
                        }
                    }
                }
            }else{
                if (aksi){
                    if (isSession){
                        return '<span class="alternative">-</span>';
                    }
                    var tgl_selesai = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y');
                    return '<div class="cell-text"><div class="subtext"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-checkmark green-600-i"></i></span><span class="info">Selesai</span>'+
                    '<div class="supporttext supporttext-dark">'+tgl_selesai+'</div></div>';
                } else {
                    return '<span class="alternative">-</span>';
                }
            }
        },

        renderPrioritasDisposisiSub: function(use_prioritas, prioritas_tgl, record) {
            if(use_prioritas == '1'){
                var tanggal = new Date(),
                    record = record,
                    aksi = record.get('aksi_id'),
                    now = Ext.util.Format.date(tanggal, 'd M Y'),
                    prioritas_tgl = prioritas_tgl,
                    tanggal_display = (prioritas_tgl)? Ext.util.Format.date(prioritas_tgl, 'd M Y') : null;

                if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);
                var is_prioritas = (prioritas_tgl < tanggal)? 1 : 0;

                if(!is_prioritas){
                    var selisih = (prioritas_tgl-tanggal)/1000,
                        hasil = Math.floor(selisih/(86400));
                    if(aksi !== null){
                        //             return '<div class="supporttext supporttext-dark"><span class="badge badge-solid margin-right-4">'+
                        //                     '<i class="icon ion-md-checkmark green-600-i"></i>'+
                        //                     '</span><span class="info">Selesai</span></div>';
                        return '';
                    }else{
                        var warna = '',
                            ikon = 'ion-md-alert',
                            info = 'Prioritas kurang '+hasil+' hari',
                            tpl = new Ext.XTemplate([
                            '<div class="supporttext supporttext-dark">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon {iconCls} {color}"></i>'+
                            '</span>'+
                            '<span class="{color}">{word}</span>'+
                            '</div>'
                            ]);

                        if (hasil <= 7){
                            warna = 'yellow-700-i';
                        }
                        if (hasil <= 3){
                            warna = 'orange-700-i';
                        }
                        if (hasil === 1){
                            warna = 'red-700-i';
                        }
                        if (hasil === 0){
                            warna = 'red-700-i';
                            info = 'Prioritas sampai hari ini';
                        }

                        return tpl.apply({
                            iconCls: ikon,
                            color: warna,
                            word: info
                        });
                    }
                }else{
                    var selisih = (tanggal-prioritas_tgl)/1000,
                        hasil = Math.floor(selisih/(86400)),
                        warna = '',
                        ikon = 'ion-md-alert',
                        info = 'Prioritas kurang '+hasil+' hari',
                        tpl = new Ext.XTemplate([
                        '<div class="supporttext supporttext-dark">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon {iconCls} {color}"></i>'+
                        '</span>'+
                        '<span class="{color}">{word}</span>'+
                        '</div>'
                        ]);

                    if(aksi !== null){
                        //             return '<div class="supporttext supporttext-dark"><span class="badge badge-solid margin-right-4">'+
                        //                     '<i class="icon ion-md-checkmark green-600-i"></i>'+
                        //                     '</span><span class="info">Selesai</span></div>';
                        return '';
                    }else{
                        if(selisih === 0){
                            warna = 'red-700-i';
                            info = 'Prioritas sampai hari ini';
                        }else{
                            warna = 'red-700-i';
                            info = 'Prioritas terlewat '+hasil+' hari';
                        }
                        return tpl.apply({
                            iconCls: ikon,
                            color: warna,
                            word: info
                        });
                    }
                }
            }else{
                return '';
            }
        },

        renderPrioritasSuratSub: function(use_prioritas, prioritas_tgl, record) {
            var mode = record.get('disposisi_mode'),
                is_selesai = record.get('surat_isselesai');

            if(use_prioritas == '1'){
                var tanggal = new Date(),
                    tgl_selesai = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y'),
                    now = Ext.util.Format.date(tanggal, 'd M Y'),
                    prioritas_tgl = prioritas_tgl,
                    tanggal_display = (prioritas_tgl)? Ext.util.Format.date(prioritas_tgl, 'd M Y') : null;

                if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);
                var is_prioritas = (prioritas_tgl < tanggal)? 1 : 0;

                if(!is_prioritas){
                    var selisih = (prioritas_tgl-tanggal)/1000,
                        hasil = Math.floor(selisih/(86400));
                    if(is_selesai == '1'){
                        return '';
                        //             return '<div class="supporttext"><span class="badge badge-solid margin-right-4">'+
                        //                 '<i class="icon ion-md-checkmark green-600-i"></i>'+
                        //                 '</span><span class="info">Selesai</span></div>';
                    }else{
                        var warna = '',
                            ikon = 'ion-md-alert',
                            info = 'Prioritas kurang '+hasil+' hari',
                            tpl = new Ext.XTemplate([
                            '<div class="supporttext supporttext-dark">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon {iconCls} {color}"></i>'+
                            '</span>'+
                            '<span class="{color}">{word}</span>'+
                            '</div>'
                            ]);

                        if (hasil <= 7){
                            warna = 'yellow-700-i';
                        }
                        if (hasil <= 3){
                            warna = 'orange-700-i';
                        }
                        if (hasil === 1){
                            warna = 'red-700-i';
                        }
                        if (hasil === 0){
                            warna = 'red-700-i';
                            info = 'Prioritas sampai hari ini';
                        }

                        return tpl.apply({
                            iconCls: ikon,
                            color: warna,
                            word: info
                        });
                    }
                }else{
                    var selisih = (tanggal-prioritas_tgl)/1000,
                        hasil = Math.floor(selisih/(86400)),
                        warna = '',
                        ikon = 'ion-md-alert',
                        info = 'Prioritas kurang '+hasil+' hari',
                        tpl = new Ext.XTemplate([
                        '<div class="supporttext supporttext-dark">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon {iconCls} {color}"></i>'+
                        '</span>'+
                        '<span class="{color}">{word}</span>'+
                        '</div>'
                        ]);

                    if(is_selesai == '1'){
                        return '';
                        //             return '<div class="supporttext"><span class="badge badge-solid margin-right-4">'+
                        //                 '<i class="icon ion-md-checkmark green-600-i"></i>'+
                        //                 '</span><span class="info">Selesai</span></div>';
                    }else{
                        if(selisih === 0){
                            warna = 'red-700-i';
                            info = 'Prioritas sampai hari ini';
                        }else{
                            warna = 'red-700-i';
                            info = 'Prioritas terlewat '+hasil+' hari';
                        }
                        return tpl.apply({
                            iconCls: ikon,
                            color: warna,
                            word: info
                        });
                    }
                }
            }else{
                if (mode != 'Disposisi' || mode != 'Nota Dinas'){
                    if(is_selesai == '1'){
                        return '<div class="supporttext supporttext-dark"><span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-checkmark green-600-i"></i>'+
                        '</span><span class="info">Selesai</span></div>';
                    } else {
                        return '';
                    }
                } else {
                    return '';
                }
            }
        },

        renderPrioritasSession: function(use_prioritas, prioritas_tgl, record, type) {
            if (type == 'surat'){

                var is_selesai = (record.get('surat_isselesai') == '1') ? true : false;
                return this.renderPrioritas(record.get('surat_prioritas'), record.get('surat_prioritas_tgl'), is_selesai, record, true);

            } else if (type == 'disposisi'){

                if(use_prioritas == '1'){
                    var tanggal = new Date(),
                        is_selesai = record.get('surat_isselesai'),
                        tgl_selesai = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y'),
                        record = record,
                        aksi = record.get('aksi_id'),
                        now = Ext.util.Format.date(tanggal, 'd M Y'),
                        prioritas_tgl = prioritas_tgl,
                        aksi_tgl = Ext.util.Format.date(record.get('disposisi_masuk_aksi_tgl'), 'd M Y'),
                        tanggal_display = (prioritas_tgl)? Ext.util.Format.date(prioritas_tgl, 'd M Y') : null,
                        tpl = new Ext.XTemplate([
                        '<div class="cell-text">'+
                        '<div class="subtext">'+
                        '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon {iconCls} {color}"></i>'+
                        '</span>'+
                        '<span class="{color}">{word}</span>'+
                        '</div>'+
                        '<div class="supporttext supporttext-dark">{tgl}</div>'+
                        '</div>']);

                    if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                    if(tanggal) tanggal.setHours(0,0,0,0);
                    var is_prioritas = (prioritas_tgl < tanggal)? 1 : 0;

                    if(!is_prioritas){
                        var selisih = (prioritas_tgl-tanggal)/1000,
                            hasil = Math.floor(selisih/(86400));

                        if(aksi !== null){
                            //                 var ikon = 'ion-md-checkmark',
                            //                     warna = 'green-600-i',
                            //                     info = 'Selesai';

                            //                 return tpl.apply({
                            //                     iconCls: ikon,
                            //                     color: warna,
                            //                     word: info,
                            //                     tgl: aksi_tgl
                            //                 });
                            return '<span class="alternative">-</span>';
                        }else{
                            var warna = 'grey-500-i',
                                ikon = 'ion-md-alert',
                                info = 'Kurang '+hasil+' hari';

                            if (hasil <= 7){
                                warna = 'yellow-700-i';
                            }
                            if (hasil <= 3){
                                warna = 'orange-700-i';
                            }
                            if (hasil === 1){
                                warna = 'red-700-i';
                            }
                            if (hasil === 0){
                                warna = 'red-700-i';
                                info = 'Sampai hari ini';
                            }

                            return tpl.apply({
                                iconCls: ikon,
                                color: warna,
                                word: info,
                                tgl: tanggal_display
                            });
                        }
                    }else{
                        var selisih = (tanggal-prioritas_tgl)/1000,
                            hasil = Math.floor(selisih/(86400)),
                            warna = 'grey-500-i',
                            ikon = 'ion-md-alert',
                            info = 'Kurang '+hasil+' hari';

                        if(aksi !== null){
                            //                 ikon = 'ion-md-checkmark';
                            //                 warna = 'green-600-i';
                            //                 info = 'Selesai';

                            //                 return tpl.apply({
                            //                     iconCls: ikon,
                            //                     color: warna,
                            //                     word: info,
                            //                     tgl: aksi_tgl
                            //                 });
                            return '<span class="alternative">-</span>';
                        }else{
                            if(selisih === 0){
                                warna = 'red-700-i';
                                info = 'Sampai hari ini';
                            }else{
                                warna = 'red-700-i';
                                info = 'Terlewat '+hasil+' hari';
                            }
                            return tpl.apply({
                                iconCls: ikon,
                                color: warna,
                                word: info,
                                tgl: tanggal_display
                            });
                        }
                    }
                }else{
                    return '<span class="alternative">-</span>';
                }

            }
        },

        renderPrioritasSupporttext: function(useprioritas, prioritas_tgl, aksi, record, type) {

            var tanggal = new Date(),
                record = record,
                //         tgl_selesai = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y'),
                now = Ext.util.Format.date(tanggal, 'd M Y'),
                prioritas_tgl = prioritas_tgl,
                tanggal_display = (prioritas_tgl)? Ext.util.Format.date(prioritas_tgl, 'd M Y') : null;

            //type '0' for render surat masuk
            if (type === 0){
                if(useprioritas !== null){
                    if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                    if(tanggal) tanggal.setHours(0,0,0,0);
                    var isprioritas = (prioritas_tgl < tanggal)? 1 : 0;
                    if(!isprioritas){
                        var selisih = (prioritas_tgl-tanggal)/1000,
                            hasil = Math.floor(selisih/(86400));
                        if(aksi){
                            return '<div class="supporttext green-600-i">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-checkmark green-600-i"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas selesai</span>'+
                            '</div>';
                        }else{
                            var _return = '<div class="supporttext supporttext-dark">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                            '</div>';
                            if (hasil <= 7){
                                _return = '<div class="supporttext yellow-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert yellow-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil <= 3){
                                _return = '<div class="supporttext orange-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert orange-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil === 1){
                                _return = '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil === 0){
                                _return = '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas sampai hari ini</span>'+
                                '</div>';
                            }

                            return _return;
                            //             return '<div class="subtext warning"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert amber-600-i"></i></span>Kurang '+hasil+' Hari</div>'+
                            //                 '<div class="supporttext">'+tanggal_display+'</div>';
                        }
                    }else{
                        var selisih = (tanggal-prioritas_tgl)/1000,
                            hasil = Math.floor(selisih/(86400));
                        if(aksi){
                            return '<div class="supporttext green-600-i">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-checkmark green-600-i"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas selesai</span>'+
                            '</div>';
                        }else{
                            if(selisih === 0){
                                return '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas sampai hari ini</span>'+
                                '</div>';
                            }else{
                                return '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas terlewat '+hasil+' hari</span>'+
                                '</div>';
                            }
                        }
                    }
                }else{
                    return '';
                }

                // type '1' for render disposisi or nota dinas
            } else if (type === 1){
                if(useprioritas == '1'){
                    if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                    if(tanggal) tanggal.setHours(0,0,0,0);
                    var isprioritas = (prioritas_tgl < tanggal)? 1 : 0;
                    if(!isprioritas){
                        var selisih = (prioritas_tgl-tanggal)/1000,
                            hasil = Math.floor(selisih/(86400));
                        if(aksi){
                            return '<div class="supporttext green-600-i">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-checkmark green-600-i"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas selesai</span>'+
                            '</div>';
                        }else{
                            var _return = '<div class="supporttext supporttext-dark">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                            '</div>';
                            if (hasil <= 7){
                                _return = '<div class="supporttext yellow-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert yellow-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil <= 3){
                                _return = '<div class="supporttext orange-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert orange-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil === 1){
                                _return = '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas kurang '+hasil+' hari</span>'+
                                '</div>';
                            }
                            if (hasil === 0){
                                _return = '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas sampai hari ini</span>'+
                                '</div>';
                            }

                            return _return;
                            //             return '<div class="subtext warning"><span class="badge badge-solid margin-right-4"><i class="icon ion-md-alert amber-600-i"></i></span>Kurang '+hasil+' Hari</div>'+
                            //                 '<div class="supporttext">'+tanggal_display+'</div>';
                        }
                    }else{
                        var selisih = (tanggal-prioritas_tgl)/1000,
                            hasil = Math.floor(selisih/(86400));
                        if(aksi){
                            return '<div class="supporttext green-600-i">'+
                            '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-checkmark green-600-i"></i>'+
                            '</span>'+
                            '<span class="info">Prioritas selesai</span>'+
                            '</div>';
                        }else{
                            if(selisih === 0){
                                return '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas sampai hari ini</span>'+
                                '</div>';
                            }else{
                                return '<div class="supporttext red-700-i">'+
                                '<span class="badge badge-solid margin-right-4">'+
                                '<i class="icon ion-md-alert red-700-i"></i>'+
                                '</span>'+
                                '<span class="info">Prioritas terlewat '+hasil+' hari</span>'+
                                '</div>';
                            }
                        }
                    }
                }else{
                    return '';
                }
            }
        },

        renderNomor: function(val, record, emptyNomor) {
            this.modelDefault = this.modelDefault || this.create({});
            var nomor = record.get('surat_nomor');
            var tpl = new Ext.Template([
            '<div class="subtext {color}">',
            '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
            '{title}',
            '</div>'
            ]);

            if (emptyNomor){
                return '<span class="alternative">-</span>';
            } else {
                if(nomor){
                    return nomor;
                }else{
                    return tpl.apply({
                        title: 'Belum Diberi Nomor',
                        color: 'warning',
                        iconCls: 'icon ion-md-warning amber-600-i'
                    });
                }
            }

        },

        renderNomorSupporttext: function(val, record, emptyNomor) {
            this.modelDefault = this.modelDefault || this.create({});
            var record = record;
            var tpl = new Ext.Template([
            '<span class="badge badge-solid margin-right-4"><i class="{iconCls}"></i></span>',
            '<span class="{color}">{title}</span>'
            ]);

            if (record.get('surat_setuju') === 2){
                return tpl.apply({
                    title: 'Belum Diberi Nomor',
                    color: 'warning',
                    iconCls: 'icon ion-md-warning amber-600-i'
                });
            } else {
                return '';
            }
        },

        renderSurat: function(value, record, model) {
            var val = value,
                ignoreRe = /PT|CV|DIVISI|BIDANG|SEKSI|DRS|IR|DR|WWW|HTTP|FTP|[^\w\s]/gi,
                modelDefault = Ext.ModelManager.getModel('SIPAS.model.Sipas.Surat');

            switch (model) {
                case 1:
                var badge = '',
                    docs = '',
                    subtext = "<div class='supporttext supporttext-dark'>"+record.get('surat_registrasi')+"</div>",
                    retensi = Ext.util.Format.date(record.get('surat_retensi_tgl'), 'd M Y'),
                    now = Ext.util.Format.date(new Date(), 'd M Y'),
                    pengirim_id = record.get('disposisi_pengirim_id'),
                    instansi_pengirim = record.get('surat_pengirim'),
                    no_surat = record.get('surat_nomor'),
                    milik = record.get('surat_milik_kode'),
                    milik_kode = '',
                    pengirim = '',
                    supporttext = '',
                    icon = '',
                    isaktif_cls = '',
                    letter_pengirim = (instansi_pengirim || "").toUpperCase().replace(ignoreRe, "").trim();

                if (instansi_pengirim === null){
                    icon = 'E';
                    pengirim = 'Dari: -';
                } else {
                    icon = letter_pengirim.charAt(0);
                    pengirim = 'Dari: '+instansi_pengirim;
                }

                if (record.get('sifat_color')){
                    if (record.get('sifat_id') == record.get('sifat_kode')){
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                    } else {
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                    }
                }

                if (no_surat){
                    supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: '+no_surat+'</span>';
                } else {
                    supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: -</span>';
                }

                if (milik){
                    milik_kode = '<span class="badge badge-outline badge-info margin-right-8">'+milik+'</span>';
                }

                if(!val){
                    val = '-';
                }

                if(now < retensi){
                    isaktif_cls = ' alternative';
                }

                return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
                '<div class="img img-circle img-32 bg-blue-500-i grey-100-i">',
                '{surat_icon}{surat_docs}',
                '</div>',
                '</div>',
                '<div class="cell-text">',
                '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
                '<div class="supporttext supporttext-black{is_aktif}">{surat_milik_kode}{surat_pengirim}</div>',
                '<div class="supporttext supporttext-dark{is_aktif}">{surat_supporttext}</div>',
                '</div></div>']).apply({
                    surat_icon: icon,
                    surat_docs: docs,
                    sifat_badge: badge,
                    surat_perihal: val,
                    surat_pengirim: pengirim,
                    surat_milik_kode: milik_kode,
                    surat_supporttext: supporttext,
                    is_aktif: isaktif_cls
                });
                break;
                case 2:
                var badge = '',
                    docs = '',
                    subtext = "<div class='supporttext supporttext-dark'>"+record.get('surat_registrasi')+"</div>",
                    pengirim_id = record.get('disposisi_pengirim_id'),
                    instansi_pengirim = record.get('surat_pengirim'),
                    instansi_tujuan = record.get('surat_tujuan'),
                    no_surat = record.get('surat_nomor'),
                    awal = record.get('jenis_nomor_awal'),
                    pengirim = '',
                    supporttext = '',
                    icon = '',
                    letter_tujuan = (instansi_tujuan || "").toUpperCase().replace(ignoreRe, "").trim(),
                    letter_pengirim = (instansi_pengirim || "").toUpperCase().replace(ignoreRe, "").trim();

                if (instansi_tujuan === null){
                    icon = 'E';
                    pengirim = 'Tujuan: -';
                } else {
                    icon = letter_tujuan.charAt(0);
                    pengirim = 'Tujuan: '+instansi_tujuan;
                }

                if (record.get('sifat_color')){
                    if (record.get('sifat_id') == record.get('sifat_kode')){
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                    } else {
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                    }
                }

                if (no_surat){
                    if(!record.get('jenis_nomor_awal') && record.get('surat_setuju') !== 2){
                        supporttext = modelDefault.renderNomorSupporttext(no_surat, record);
                    }else if(record.get('surat_nomor_issalin')){
                        supporttext = '<span class="icon ion-md-close red-700-i">'+
                        ' No.Surat Sudah Dipindahkan</span>';
                    }else{
                        supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                        'No.Surat: '+no_surat+'</span>';
                    }
                } else {
                    supporttext = modelDefault.renderNomorSupporttext(no_surat, record);
                }

                if(!val){
                    val = '-';
                }

                return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
                '<div class="img img-circle img-32 bg-amber-500-i grey-100-i">',
                '{surat_icon}{surat_docs}',
                '</div>',
                '</div>',
                '<div class="cell-text">',
                '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
                '<div class="supporttext supporttext-black">{surat_pengirim}</div>',
                '<div class="supporttext supporttext-dark">{surat_supporttext}</div>',
                '</div></div>']).apply({
                    surat_icon: icon,
                    surat_docs: docs,
                    sifat_badge: badge,
                    surat_perihal: val,
                    surat_pengirim: pengirim,
                    surat_supporttext: supporttext
                });
                break;
                case 3:
                var badge = '',
                    docs = '',
                    tgl_terima_induk = Ext.util.Format.date(record.get('surat_induk_setuju_tgl'), 'd M Y H:i'),
                    tgl_terima = Ext.util.Format.date(record.get('surat_setuju_tgl'), 'd M Y H:i'),
                    subtext = "<div class='supporttext supporttext-dark'>"+record.get('surat_registrasi')+"</div>",
                    pengirim_id = record.get('disposisi_pengirim_id'),
                    unit_pengirim = record.get('unit_source_nama'),
                    supporttext = 'Dari: -',
                    icon = 'I',
                    no_surat = record.get('surat_nomor'),
                    letter_pengirim = (unit_pengirim || "").toUpperCase().replace(ignoreRe, "").trim();
                if (record.get('sifat_color')){
                    if (record.get('sifat_id') == record.get('sifat_kode')){
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                    } else {
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                    }
                }

                if (no_surat){
                    no_surat = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: '+no_surat+'</span>';
                } else {
                    no_surat = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: -</span>';
                }

                if (unit_pengirim){
                    icon = letter_pengirim.charAt(0);
                    supporttext = 'Dari: '+unit_pengirim;
                }

                if(!val){
                    val = '-';
                }

                return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
                '<div class="img img-circle img-32 bg-deep-purple-500-i grey-100-i">',
                '{surat_icon}{surat_docs}',
                '</div>',
                '</div>',
                '<div class="cell-text">',
                '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
                '<div class="supporttext supporttext-black">{surat_supporttext}</div>',
                '<div class="supporttext supporttext-dark">{no_surat}</div>',
                '</div></div>']).apply({
                    surat_icon: icon,
                    surat_docs: docs,
                    sifat_badge: badge,
                    surat_perihal: val,
                    no_surat: no_surat,
                    surat_supporttext: supporttext
                });
                break;
                case 4:
                var badge = '',
                    docs = '',
                    subtext = "<div class='supporttext supporttext-dark'>"+record.get('surat_registrasi')+"</div>",
                    pengirim_id = record.get('disposisi_pengirim_id'),
                    unit_pengirim = record.get('distributor_unit_nama'),
                    supporttext = '',
                    icon = 'I',
                    letter_pengirim = (unit_pengirim || "").toUpperCase().replace(ignoreRe, "").trim(),
                    no_surat = record.get('surat_nomor'),
                    setuju = record.get('surat_imasuk_setuju'),
                    tolak = record.get('surat_imasuk_tolak'),
                    pending = record.get('surat_imasuk_pending'),
                    sorter = record.get('surat_sorter'),
                    sub_word = '',
                    no_surat = record.get('surat_nomor'),
                    milik = record.get('surat_milik_kode'),
                    milik_kode = '',
                    rtolak = '',
                    rsetuju = '',
                    rpending = '';

                if (record.get('sifat_color')){
                    if (record.get('sifat_id') == record.get('sifat_kode')){
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                    } else {
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                    }
                }


                if (no_surat){
                    if(!record.get('jenis_nomor_awal') && record.get('surat_setuju') !== 2){
                        no_surat = '';
                    }else if(record.get('surat_nomor_issalin')){
                        no_surat = '<span class="icon ion-md-close red-700-i">'+
                        ' No.Surat Sudah Dipindahkan</span>';
                    }else{
                        no_surat = '<span class="badge badge-outline badge-primary margin-right-8">'+
                        'No.Surat: '+no_surat+'</span>';
                    }
                } else {
                    no_surat = modelDefault.renderNomorSupporttext(no_surat, record);
                }

                if (milik){
                    milik_kode = '<span class="badge badge-outline badge-info margin-right-8">'+milik+'</span>';
                }

                if(!val){
                    val = '-';
                }

                if(record.get('surat_imasuk_total') != "0"){
                    sub_word = 'Unit penerima: ';
                    if(setuju != "0"){
                        rsetuju = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-checkmark green-700-i margin-right-4"></i>'+
                        '</span>'+
                        '<span class="info">'+setuju+'</span>'+
                        '</span>';
                        //         rsetuju = '<span class="margin-right-8"><span class="badge badge-solid info"><i class="icon ion-md-checkmark green-700-i margin-right-4"></i></span><span class="info">'+setuju+' Unit Menerima</span></span>';
                    }
                    if(pending != "0"){
                        rpending = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-timer supporttext-dark margin-right-4"></i>'+
                        '</span>'+
                        '<span class="alternative">'+pending+'</span>'+
                        '</span>';
                        //         rpending = '<span class="margin-right-8"><span class="badge badge-solid alternative"><i class="icon ion-md-timer grey-700-i margin-right-4"></i></span><span class="alternative">'+pending+' Unit Belum Menanggapi</span></span>';
                    }
                    if(tolak != "0"){
                        rtolak = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-close red-700-i margin-right-4"></i>'+
                        '</span>'+
                        '<span class="danger">'+tolak+'</span>'+
                        '</span>';
                        //         rtolak = '<span class="margin-right-8"><span class="badge badge-solid danger"><i class="icon ion-md-close red-700-i margin-right-4"></i></span><span class="danger">'+tolak+' Unit Menolak</span></span>';
                    }

                    if(sorter == "0"){
                        supporttext = '<b>'+rpending+rsetuju+rtolak+'</b>';
                    }else{
                        supporttext = rpending+rsetuju+rtolak;
                    }
                }

                return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
                '<div class="img img-circle img-32 bg-deep-orange-500-i grey-100-i">',
                '{surat_icon}{surat_docs}',
                '</div>',
                '</div>',
                '<div class="cell-text">',
                '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
                '<div class="supporttext supporttext-black">{surat_milik_kode}{word_sub}{surat_supporttext}</div>',
                '<div class="supporttext supporttext-dark">{no}</div>',
                '</div></div>']).apply({
                    surat_icon: icon,
                    surat_docs: docs,
                    sifat_badge: badge,
                    surat_perihal: val,
                    no: no_surat,
                    surat_milik_kode: milik_kode,
                    word_sub: sub_word,
                    surat_supporttext: supporttext
                });
                break;
                case 6:
                var badge = '',
                    docs = '',
                    subtext = "<div class='supporttext supporttext-dark'>"+record.get('surat_registrasi')+"</div>",
                    pengirim_id = record.get('disposisi_pengirim_id'),
                    unit_pengirim = record.get('distributor_unit_nama'),
                    supporttext = '',
                    icon = 'I',
                    letter_pengirim = (unit_pengirim || "").toUpperCase().replace(ignoreRe, "").trim(),
                    no_surat = record.get('surat_nomor'),
                    setuju = record.get('surat_imasuk_setuju'),
                    tolak = record.get('surat_imasuk_tolak'),
                    pending = record.get('surat_imasuk_pending'),
                    sorter = record.get('surat_sorter'),
                    sub_word = '',
                    no_surat = record.get('surat_nomor'),
                    rtolak = '',
                    rsetuju = '',
                    rpending = '';

                if (record.get('sifat_color')){
                    if (record.get('sifat_id') == record.get('sifat_kode')){
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                    } else {
                        badge = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                    }
                }


                if (no_surat){
                    if(!record.get('jenis_nomor_awal') && ((record.get('surat_model_sub') == 2 && (record.get('surat_setuju') !== 2 || record.get('surat_petikan_setuju') !== 2)) || (record.get('surat_model_sub') == 1 && record.get('surat_setuju') !== 2))){
                        no_surat = '';
                    }else if(record.get('surat_nomor_issalin')){
                        no_surat = '<span class="icon ion-md-close red-700-i">'+
                        ' No.Surat Sudah Dipindahkan</span>';
                    }else{
                        no_surat = '<span class="badge badge-outline badge-primary margin-right-8">'+
                        'No.Surat: '+no_surat+'</span>';
                    }
                } else {
                    no_surat = modelDefault.renderNomorSupporttext(no_surat, record);
                }


                if(!val){
                    val = '-';
                }

                if(record.get('surat_imasuk_total') != "0"){
                    sub_word = 'Unit penerima: ';
                    if(setuju != "0"){
                        rsetuju = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-checkmark green-700-i margin-right-4"></i>'+
                        '</span>'+
                        '<span class="info">'+setuju+'</span>'+
                        '</span>';
                        //         rsetuju = '<span class="margin-right-8"><span class="badge badge-solid info"><i class="icon ion-md-checkmark green-700-i margin-right-4"></i></span><span class="info">'+setuju+' Unit Menerima</span></span>';
                    }
                    if(pending != "0"){
                        rpending = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-timer supporttext-dark margin-right-4"></i>'+
                        '</span>'+
                        '<span class="alternative">'+pending+'</span>'+
                        '</span>';
                        //         rpending = '<span class="margin-right-8"><span class="badge badge-solid alternative"><i class="icon ion-md-timer grey-700-i margin-right-4"></i></span><span class="alternative">'+pending+' Unit Belum Menanggapi</span></span>';
                    }
                    if(tolak != "0"){
                        rtolak = '<span class="margin-right-8">'+
                        '<span class="badge badge-solid alternative">'+
                        '<i class="icon ion-md-close red-700-i margin-right-4"></i>'+
                        '</span>'+
                        '<span class="danger">'+tolak+'</span>'+
                        '</span>';
                        //         rtolak = '<span class="margin-right-8"><span class="badge badge-solid danger"><i class="icon ion-md-close red-700-i margin-right-4"></i></span><span class="danger">'+tolak+' Unit Menolak</span></span>';
                    }

                    if(sorter == "0"){
                        supporttext = '<b>'+rpending+rsetuju+rtolak+'</b>';
                    }else{
                        supporttext = rpending+rsetuju+rtolak;
                    }
                }

                return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
                '<div class="img img-circle img-32 bg-deep-orange-500-i grey-100-i">',
                '{surat_icon}{surat_docs}',
                '</div>',
                '</div>',
                '<div class="cell-text">',
                '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
                '<div class="supporttext supporttext-black">{word_sub}{surat_supporttext}</div>',
                '<div class="supporttext supporttext-dark">{no}</div>',
                '</div></div>']).apply({
                    surat_icon: icon,
                    surat_docs: docs,
                    sifat_badge: badge,
                    surat_perihal: val,
                    no: no_surat,
                    word_sub: sub_word,
                    surat_supporttext: supporttext
                });
                break;
            }
        },

        renderSuratBadges: function(record, is_surat) {
            switch (record.get('surat_model')){
                case 1:
                // masuk
                var badge1 = '<span class="badge badge-light bg-blue-100-i margin-right-8">'+
                '<span class="blue-700">Instansi</span>'+
                '</span>',
                badge2 = record.get('jenis_nama') ? '<span class="badge badge-light bg-pink-100-i margin-right-8">'+
                '<span class="pink-700">'+record.get('jenis_nama')+'</span>'+
                '</span>' : '',
                badge3 = is_surat ? this.renderPrioritasSuratBadge(record, true) : this.renderPrioritasSuratBadge(record, true) /*this.renderPrioritasDisposisiBadge(record, true)*/,
                badge4 = is_surat ? this.renderPrioritasSuratBadge(record, false) : this.renderPrioritasDisposisiBadge(record, false);

                badges = badge1 + '<span class="margin-left-2 margin-right-2">'+badge2+'</span>' + badge3 + badge4;
                break;
                case 2:
                // keluar
                // record.get('unit_kode');
                var badge1 = '<span class="badge badge-light bg-blue-100-i margin-right-8">'+
                '<span class="blue-700">Instansi</span>'+
                '</span>',
                badge2 = record.get('jenis_nama') ? '<span class="badge badge-light bg-pink-100-i margin-right-8">'+
                '<span class="pink-700">'+record.get('jenis_nama')+'</span>'+
                '</span>' : '',
                badge3 = is_surat ? this.renderPrioritasSuratBadge(record, true) : this.renderPrioritasSuratBadge(record, true) /*this.renderPrioritasDisposisiBadge(record, true)*/,
                badge4 = is_surat ? this.renderPrioritasSuratBadge(record, false) : this.renderPrioritasDisposisiBadge(record, false);

                badges = badge1 + '<span class="margin-left-2 margin-right-2">'+badge2+'</span>' + badge3 + badge4;
                break;
                case 3:
                // imasuk
                var badge1 = '<span class="badge badge-light bg-brown-100-i margin-right-8">'+
                '<span class="brown-700">'+record.get('unit_source_kode')+'</span>'+
                '</span>',
                badge2 = record.get('jenis_nama') ? '<span class="badge badge-light bg-pink-100-i margin-right-8">'+
                '<span class="pink-700">'+record.get('jenis_nama')+'</span>'+
                '</span>' : '',
                badge3 = is_surat ? this.renderPrioritasSuratBadge(record, true) : this.renderPrioritasSuratBadge(record, true) /*this.renderPrioritasDisposisiBadge(record, true)*/,
                badge4 = is_surat ? this.renderPrioritasSuratBadge(record, false) : this.renderPrioritasDisposisiBadge(record, false);

                badges = badge1 + '<span class="margin-left-2 margin-right-2">'+badge2+'</span>' + badge3 + badge4;
                break;
                case 4:
                // ikeluar
                var badge1 = '<span class="badge badge-light bg-brown-100-i margin-right-8">'+
                '<span class="brown-700">'+record.get('unit_kode')+'</span>'+
                '</span>',
                badge2 = record.get('jenis_nama') ? '<span class="badge badge-light bg-pink-100-i margin-right-8">'+
                '<span class="pink-700">'+record.get('jenis_nama')+'</span>'+
                '</span>' : '',
                badge3 = is_surat ? this.renderPrioritasSuratBadge(record, true) : this.renderPrioritasSuratBadge(record, true) /*this.renderPrioritasDisposisiBadge(record, true)*/,
                badge4 = is_surat ? this.renderPrioritasSuratBadge(record, false) : this.renderPrioritasDisposisiBadge(record, false);

                badges = badge1 + '<span class="margin-left-2 margin-right-2">'+badge2+'</span>' + badge3 + badge4;
                break;
                case 6:
                // keputusan
                var badge1 = '<span class="badge badge-light bg-brown-100-i margin-right-8">'+
                '<span class="brown-700">'+record.get('unit_kode')+'</span>'+
                '</span>',
                badge2 = record.get('jenis_nama') ? '<span class="badge badge-light bg-pink-100-i margin-right-8">'+
                '<span class="pink-700">'+record.get('jenis_nama')+'</span>'+
                '</span>' : '',
                badge3 = is_surat ? this.renderPrioritasSuratBadge(record, true) : this.renderPrioritasSuratBadge(record, true) /*this.renderPrioritasDisposisiBadge(record, true)*/,
                badge4 = is_surat ? this.renderPrioritasSuratBadge(record, false) : this.renderPrioritasDisposisiBadge(record, false);

                badges = badge1 + '<span class="margin-left-2 margin-right-2">'+badge2+'</span>' + badge3 + badge4;
                break;
            }
            return badges;
        },

        renderPrioritasSuratBadge: function(record, is_badge) {
            var prioritas_nama = record.get('prioritas_nama'),
                useprioritas = record.get('surat_prioritas') ? true : false,
                prioritas_tgl = record.get('surat_prioritas_tgl'),
                is_selesai = record.get('surat_isselesai'),
                tpl_badge = '',
                tpl = '';

            if(useprioritas){
                var tanggal = new Date(),
                    tanggal_selesai_display = Ext.util.Format.date(record.get('surat_selesai_tgl'), 'd M Y H:i'),
                    tanggal_display = Ext.util.Format.date(prioritas_tgl, 'd M Y');

                // if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);
                var isprioritas = (prioritas_tgl < tanggal)? 1 : 0,
                    selisih = (prioritas_tgl-tanggal)/1000,
                    hasil = Math.floor(selisih/(86400));

                if(!isprioritas){
                    if (is_selesai == 1){
                        tpl_badge = '<span class="badge badge-light bg-green-100-i margin-right-8">'+
                        '<span class="info">'+prioritas_nama+'</span></span>';
                    } else {
                        tpl = '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-alert grey-700-i"></i>'+
                        '</span><span class="grey-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                        '<span class="alternative"> ('+tanggal_display+')</span>';

                        tpl_badge = '<span class="badge badge-light bg-grey-300-i margin-right-8">'+
                        '<span class="grey-700">'+prioritas_nama+'</span></span>';

                        if (hasil <= 7){
                            tpl_badge = '<span class="badge badge-light bg-yellow-100-i margin-right-8">'+
                            '<span class="yellow-800">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert yellow-700-i"></i>'+
                            '</span><span class="yellow-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }

                        if (hasil <= 3){
                            tpl_badge = '<span class="badge badge-light bg-orange-100-i margin-right-8">'+
                            '<span class="orange-700">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert orange-700-i"></i>'+
                            '</span><span class="orange-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }

                        if (hasil == 1){
                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="danger">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert danger"></i>'+
                            '</span><span class="danger margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }

                        if(hasil == 0){
                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="danger">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert red-700-i"></i>'+
                            '</span><span class="danger margin-right-4">Sampai hari ini</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }
                    }
                }else{
                    var selisih = (tanggal-prioritas_tgl)/1000;

                    if(is_selesai == 1){
                        tpl_badge = '<span class="badge badge-light bg-green-100-i margin-right-8">'+
                        '<span class="info">'+prioritas_nama+'</span></span>';
                    }else{
                        if(selisih == 0){
                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="danger">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert red-700-i"></i>'+
                            '</span><span class="danger margin-right-4">Sampai hari ini</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }else{
                            tpl_badge = '<span class="badge badge-light bg-grey-300-i margin-right-8">'+
                            '<span class="alternative">'+prioritas_nama+'</span></span>';

                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert red-700-i"></i>'+
                            '</span><span class="danger margin-right-4">Terlewat '+Math.abs(hasil)+' hari</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';
                        }
                    }
                }
            }

            if (is_badge){
                return tpl_badge;
            } else {
                return tpl;
            }
        },

        renderPrioritasDisposisiBadge: function(record, is_badge) {
            var useprioritas = record.get('disposisi_useprioritas') == 1 ? true : false,
                prioritas_tgl = record.get('disposisi_prioritas_tgl'),
                is_selesai = record.get('disposisi_masuk_aksi'),
                prioritas_nama = record.get('prioritas_nama'),
                tpl = '',
                tpl_badge = '';

            if(useprioritas){
                var tanggal = new Date(),
                    tanggal_selesai_display = Ext.util.Format.date(record.get('disposisi_masuk_aksi_tgl'), 'd M Y H:i'),
                    tanggal_display = Ext.util.Format.date(prioritas_tgl, 'd M Y');

                // if(prioritas_tgl) prioritas_tgl.setHours(0,0,0,0);
                if(tanggal) tanggal.setHours(0,0,0,0);
                var isprioritas = (prioritas_tgl < tanggal) ? true : false,
                    selisih = (prioritas_tgl-tanggal)/1000,
                    hasil = Math.floor(selisih/(86400));

                if(!isprioritas){
                    if (is_selesai){
                        tpl = '';
                        tpl_badge = '<span class="badge badge-light bg-green-100-i margin-right-8">'+
                        '<span class="info">'+prioritas_nama+'</span></span>';
                    } else {
                        tpl = '<span class="badge badge-solid margin-right-4">'+
                        '<i class="icon ion-md-alert grey-700-i"></i>'+
                        '</span><span class="grey-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                        '<span class="alternative"> ('+tanggal_display+')</span>';

                        tpl_badge = '<span class="badge badge-light bg-grey-300-i margin-right-8">'+
                        '<span class="grey-700">'+prioritas_nama+'</span></span>';

                        if (hasil <= 7){
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert yellow-700-i"></i>'+
                            '</span><span class="yellow-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-yellow-100-i margin-right-8">'+
                            '<span class="yellow-800">'+prioritas_nama+'</span></span>';
                        }

                        if (hasil <= 3){
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert orange-700-i"></i>'+
                            '</span><span class="orange-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-orange-100-i margin-right-8">'+
                            '<span class="orange-700">'+prioritas_nama+'</span></span>';
                        }

                        if (hasil == 1){
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert red-700-i"></i>'+
                            '</span><span class="red-700-i margin-right-4">'+hasil+' hari lagi</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="red-700">'+prioritas_nama+'</span></span>';
                        }

                        if(hasil == 0){
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert danger"></i>'+
                            '</span><span class="danger margin-right-4">Sampai hari ini</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="danger">'+prioritas_nama+'</span></span>';
                        }
                    }
                }else{
                    var selisih = (tanggal-prioritas_tgl)/1000;

                    if(is_selesai){
                        tpl = '';
                        tpl_badge = '<span class="badge badge-light bg-green-100-i margin-right-8">'+
                        '<span class="info">'+prioritas_nama+'</span></span>';
                    }else{
                        if(selisih == 0){
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert danger"></i>'+
                            '</span><span class="danger margin-right-4">Sampai hari ini</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-red-100-i margin-right-8">'+
                            '<span class="danger">'+prioritas_nama+'</span></span>';
                        }else{
                            tpl = '<span class="badge badge-solid margin-right-4">'+
                            '<i class="icon ion-md-alert danger"></i>'+
                            '</span><span class="danger margin-right-4">Terlewat '+Math.abs(hasil)+' hari</span>'+
                            '<span class="alternative"> ('+tanggal_display+')</span>';

                            tpl_badge = '<span class="badge badge-light bg-grey-300-i margin-right-8">'+
                            '<span class="alternative">'+prioritas_nama+'</span></span>';
                        }
                    }
                }
            }

            if (is_badge){
                return tpl_badge;
            } else {
                return tpl;
            }
        },

        renderSuratSessionList: function(value, mode, record) {
            var val = value,
                ignoreRe = /PT|CV|DIVISI|BIDANG|SEKSI|DRS|IR|DR|WWW|HTTP|FTP|[^\w\s]/gi,
                badge_sifat = '',
                modelSurat = Ext.ModelManager.getModel('SIPAS.model.Sipas.Surat'),
                modelDM = Ext.ModelManager.getModel('SIPAS.model.Sipas.disposisi.Masuk'),
                modelRiwayat = Ext.ModelManager.getModel('SIPAS.model.Sipas.disposisi.Riwayat'),
                disposisi_mode = record.get('disposisi_model_sub'),
                model = record.get('surat_model'),
                model_sub = record.get('surat_model_sub') ? record.get('surat_model_sub') : 0,
                terima_berkas = record.get('disposisi_masuk_isberkasterima'),
                pengirim_id = record.get('disposisi_pengirim_id'),
                instansi_pengirim = record.get('surat_pengirim'),
                unit_pengirim = record.get('unit_source_nama'),
                unit_nama = record.get('unit_nama'),
                tujuan = record.get('surat_tujuan'),
                no_surat = record.get('surat_nomor'),
                surat_prioritas = record.get('surat_prioritas'),
                milik_kode = record.get('surat_milik_kode'),
                disposisi_useprioritas = record.get('disposisi_useprioritas'),
                pengirim = '',
                supporttext = '',
                no_reg = record.get('surat_registrasi'),
                is_tembusan = record.get('disposisi_masuk_istembusan'),
                is_berkas = record.get('disposisi_masuk_isberkas'),
                is_rahasia = record.get('disposisi_israhasia'),
                ispengingat = record.get('disposisi_masuk_ispengingat'),
                isprioritas = record.get('disposisi_masuk_isprioritas'),
                tembusan_icon = '<span class="badge badge-solid margin-right-4"><i class="icon ion-logo-closed-captioning"></i></span>',
                berkas_icon = '<span class="badge badge-solid margin-right-4"><i class="ion ion-md-copy"></i></span>',
                icon = '',
                baca = ' bold',
                tpl_prioritas = '',
                tpl_badges = '',
                count_penerima = '',
                is_disposisi = false,
                tpl_subcell = '',
                tpl_rahasia = '',
                pengingat = '',
                milik = '',
                letter_tujuan = (tujuan || "").toUpperCase().replace(ignoreRe, "").trim(),
                letter_pengirim = (instansi_pengirim || "").toUpperCase().replace(ignoreRe, "").trim(),
                letter_unit_pengirim = (unit_pengirim || "").toUpperCase().replace(ignoreRe, "").trim(),
                letter_unit_nama = (unit_nama || "").toUpperCase().replace(ignoreRe, "").trim();

            switch (mode) {
                case 'disposisi':
                case 'nota_dinas':
                if (is_rahasia == 1){
                    tpl_rahasia = '<span class="badge badge-solid danger">'+
                    '<i class="ion ion-md-lock"></i></span>';
                }

                count_penerima = '<span class="badge badge-fill">'+
                record.get('disposisi_masuk_jumlah_penerima')+
                '<i class="margin-left-4 ion ion-md-people"></i></span>';

                is_disposisi = true;
                tpl_subcell = modelDM.renderPengirimDisposisi(record);
                tpl_badges = modelSurat.renderSuratBadges(record, false);

                switch (mode) {
                    case 'disposisi':
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailusertree bg-red-500-i"></div>';
                    break;
                    case 'nota_dinas':
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailuserforward bg-cyan-500-i"></div>';
                    break;
                }
                break;
                case 'riwayat':
                is_disposisi = true;
                tpl_badges = modelSurat.renderSuratBadges(record, false);

                //         if (disposisi_mode == 0){
                //             tpl_subcell = modelRiwayat.renderDetailRiwayat(record, true);
                //         } else if (disposisi_mode == 1){
                //             tpl_subcell = modelRiwayat.renderDetailRiwayat(record, false);
                //         }

                switch (model) {
                    case 1:
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-maildownload bg-blue-500-i"></div>';
                    break;
                    case 2:
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailupload bg-amber-500-i"></div>';
                    break;
                    case 3:
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-deep-purple-500-i"></div>';
                    break;
                    case 4:
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-deep-orange-500-i"></div>';
                    break;
                    case 6:
                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-brown-500-i"></div>';
                    break;
                }
                break;
                default:
                is_disposisi = false;
                tpl_badges = modelSurat.renderSuratBadges(record, true);

                if (mode === 'draf'){
                    var setuju = record.get('disposisi_masuk_status'),
                        subbadge = '';

                    if (setuju == 0 || setuju == 1){
                        subbadge = '<div class="badge badge-right badge-bottom bg-orange-500-i"><i class="ion ion-md-warning"></i></div>';
                    } else if (setuju == 2){
                        subbadge = '<div class="badge badge-right badge-bottom bg-green-500-i"><i class="ion ion-md-checkmark"></i></div>';
                    } else if (setuju == 4){
                        subbadge = '<div class="badge badge-right badge-bottom bg-red-500-i"><i class="ion ion-md-close"></i></div>';
                    }

                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailupload bg-brown-700-i">'+subbadge+'</div>';
                } else if (mode === 'petikan'){
                    var setuju = record.get('disposisi_masuk_status'),
                        subbadge = '';

                    if (setuju == 0 || setuju == 1){
                        subbadge = '<div class="badge badge-right badge-bottom bg-orange-500-i"><i class="ion ion-md-warning"></i></div>';
                    } else if (setuju == 2){
                        subbadge = '<div class="badge badge-right badge-bottom bg-green-500-i"><i class="ion ion-md-checkmark"></i></div>';
                    } else if (setuju == 4){
                        subbadge = '<div class="badge badge-right badge-bottom bg-red-500-i"><i class="ion ion-md-close"></i></div>';
                    }

                    icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailupload bg-brown-700-i">'+subbadge+'</div>';
                } else if (mode === 'masuk') {
                    count_penerima = '<span class="badge badge-fill">'+
                    record.get('disposisi_masuk_jumlah_penerima')+
                    '<i class="margin-left-4 ion ion-md-people"></i></span>';
                    switch (model) {
                        case 1:
                        icon = '<div class="img img-icon img-icon-20 img-circle img-icon-maildownload bg-blue-500-i"></div>';
                        break;
                        case 2:
                        icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailupload bg-amber-500-i"></div>';
                        break;
                        case 3:
                        icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-deep-purple-500-i"></div>';
                        break;
                        case 4:
                        icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-deep-orange-500-i"></div>';
                        break;
                        case 6:
                        icon = '<div class="img img-icon img-icon-20 img-circle img-icon-mailforward bg-brown-500-i"></div>';
                        break;
                    }
                }
                break;
            }

            if (no_surat){
                if(!record.get('jenis_nomor_awal') && ((model !== 6 && model !== 1) || (model === 6 && model_sub === 1)) && record.get('surat_setuju') !== '2'){
                    supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: -</span>';
                } else if(!record.get('jenis_nomor_awal') && model === 6 && model_sub === 2 && record.get('surat_petikan_setuju') !== '2'){
                    supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: -</span>';
                } else {
                    supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                    'No.Surat: '+no_surat+'</span>';
                }
            } else {
                supporttext = '<span class="badge badge-outline badge-primary margin-right-8">'+
                'No.Surat: -</span>';
            }

            if (milik_kode){
                milik = '<span class="badge badge-outline badge-info margin-right-8">'+milik_kode+'</span>';
            }

            if (is_tembusan !== 1){
                tembusan_icon = '';
            }

            if (is_berkas == "1"){
                if (terima_berkas == "1"){
                    berkas_icon = '<span class="badge badge-solid margin-right-4"><i class="ion ion-md-copy green-700-i"></i></span>';
                }
            } else {
                berkas_icon = '';
            }

            if (record.get('sifat_color')){
                if (record.get('sifat_id') == record.get('sifat_kode')){
                    badge_sifat = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">#</span>';
                } else {
                    badge_sifat = '<span class="badge badge-light margin-right-4" style="background-color:'+record.get('sifat_color')+';">'+record.get('sifat_kode')+'</span>';
                }
            }

            if (no_reg){
                no_reg = '<span class="badge badge-outline margin-right-8">'+
                '<span class="alternative">No.Reg: '+no_reg+'</span></span>';
            } else {
                no_reg = '<span class="badge badge-outline margin-right-8">'+
                '<span class="alternative">No.Reg: -</span></span>';
            }

            if(ispengingat == 1){
                pengingat = '<div class="badge badge-danger badge-bold"><span class="bold">DIINGATKAN</span></div>';
            }
            // else if(isprioritas == 1){
            //     pengingat = '<div class="badge badge-outline badge-primary badge-bold">DIINGATKAN</div>';
            // }

            switch (model) {
                case 1:
                pengirim = instansi_pengirim;
                break;
                case 2:
                pengirim = unit_nama;
                break;
                case 3:
                pengirim = unit_pengirim;
                break;
                case 4:
                pengirim = unit_nama;
                break;
                case 6:
                pengirim = unit_nama;
                break;
            }

            return new Ext.XTemplate(['<div class="cell-row"><div class="cell-visual cell-visual-left">',
            '{surat_icon}',
            '</div>',
            '<div class="cell-text">',
            '<div class="subtext" style="margin-bottom: 2px">{pengingat}</div>',
            '<div class="subtext ellipsis">{surat_pengirim}</div>',
            '<div class="subtext ellipsis">{sifat_badge}{surat_perihal}</div>',
            '<div class="supporttext supporttext-dark margin-top-4 margin-bottom-4 ellipsis">{milik_kode}{tembusan}{berkas}{surat_supporttext}{no_reg}</div>',
            '<div class="supporttext">{badges}{rahasia}{penerima}</div>',
            '<tpl if="values.is_disposisi === true">{tpl_subcell}</tpl>',
            '</div></div>']).apply({
                surat_icon: icon,
                sifat_badge: badge_sifat,
                surat_perihal: val,
                surat_pengirim: pengirim,
                surat_supporttext: supporttext,
                no_reg: no_reg,
                penerima: count_penerima,
                is_disposisi: is_disposisi,
                tpl_subcell: tpl_subcell,
                badges: tpl_badges,
                rahasia: tpl_rahasia,
                pengingat: pengingat,
                milik_kode: milik
            });
        },

        modelType: function() {
            return {
                MODEL_MASUK : 1,
                MODEL_MASUK_DISPLAY : '<div>Eksternal</div><div class="supporttext supporttext-dark">Masuk</div>',
                MODEL_KELUAR : 2,
                MODEL_KELUAR_DISPLAY : '<div>Eksternal</div><div class="supporttext supporttext-dark">Keluar</div>',
                MODEL_IMASUK : 3,
                MODEL_IMASUK_DISPLAY : '<div>Internal</div><div class="supporttext supporttext-dark">Masuk</div>',
                MODEL_IKELUAR : 4,
                MODEL_IKELUAR_DISPLAY : '<div>Internal</div><div class="supporttext supporttext-dark">Keluar</div>',
                MODEL_BEBAS : 5,
                MODEL_BEBAS_DISPLAY : 'Keluar Internal',
                MODEL_KEPUTUSAN : 6,
                MODEL_KEPUTUSAN_DISPLAY : '<div>Internal</div><div class="supporttext supporttext-dark">Keputusan</div>'
            };
        }
    },

    idProperty: 'surat_id',

    proxy: {
        type: 'ajax',
        apis: {
            masuk: {
                create: 'server.php/sipas/surat_masuk/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_masuk/update',
                destroy: 'server.php/sipas/surat_masuk/destroy'
            },
            keluar: {
                create: 'server.php/sipas/surat_keluar/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_keluar/update',
                destroy: 'server.php/sipas/surat_keluar/destroy'
            },
            imasuk: {
                create: 'server.php/sipas/surat_imasuk/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_imasuk/update',
                destroy: 'server.php/sipas/surat_imasuk/destroy'
            },
            ikeluar: {
                create: 'server.php/sipas/surat_ikeluar/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_ikeluar/update',
                destroy: 'server.php/sipas/surat_ikeluar/destroy'
            },
            bebas: {
                create: 'server.php/sipas/surat_bebas/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_bebas/update',
                destroy: 'server.php/sipas/surat_bebas/destroy'
            },
            keputusan: {
                create: 'server.php/sipas/surat_keputusan/create',
                read: 'server.php/sipas/surat/read',
                update: 'server.php/sipas/surat_keputusan/update',
                destroy: 'server.php/sipas/surat_keputusan/destroy'
            }
        },
        api: {
            create: 'server.php/sipas/surat/create',
            read: 'server.php/sipas/surat/read',
            update: 'server.php/sipas/surat/update',
            destroy: 'server.php/sipas/surat/destroy'
        },
        reader: {
            type: 'json',
            root: 'data'
        }
    },

    fields: [
        {
            name: 'surat_id'
        },
        {
            name: 'surat_arsip'
        },
        {
            name: 'surat_model',
            type: 'int'
        },
        {
            name: 'surat_model_sub',
            type: 'int'
        },
        {
            name: 'surat_itipe'
        },
        {
            name: 'surat_registrasi'
        },
        {
            name: 'surat_nomor'
        },
        {
            name: 'surat_agenda'
        },
        {
            name: 'surat_agenda_sub'
        },
        {
            name: 'surat_tanggal',
            type: 'date'
        },
        {
            name: 'surat_perihal'
        },
        {
            name: 'surat_pengirim'
        },
        {
            name: 'surat_tujuan'
        },
        {
            name: 'surat_lampiran'
        },
        {
            name: 'surat_ringkasan'
        },
        {
            name: 'surat_catatan'
        },
        {
            name: 'surat_korespondensi'
        },
        {
            name: 'surat_korespondensi_surat'
        },
        {
            name: 'surat_tmt',
            type: 'date'
        },
        {
            name: 'surat_lokasi'
        },
        {
            name: 'surat_kelas'
        },
        {
            name: 'surat_keluar_type'
        },
        {
            name: 'surat_jenis'
        },
        {
            name: 'surat_jenis_sub',
            type: 'int'
        },
        {
            name: 'surat_sifat'
        },
        {
            name: 'surat_media'
        },
        {
            name: 'surat_prioritas'
        },
        {
            name: 'surat_retensi_tgl',
            type: 'date'
        },
        {
            name: 'surat_useretensi',
            type: 'boolean'
        },
        {
            name: 'surat_properti'
        },
        {
            name: 'surat_unit'
        },
        {
            name: 'surat_setuju',
            type: 'int'
        },
        {
            name: 'surat_setuju_tgl',
            type: 'date'
        },
        {
            name: 'surat_setuju_isurut',
            type: 'boolean'
        },
        {
            name: 'surat_setuju_staf'
        },
        {
            name: 'surat_setuju_profil'
        },
        {
            name: 'surat_petikan_setuju_isurut',
            type: 'boolean'
        },
        {
            name: 'surat_petikan_setuju',
            type: 'int'
        },
        {
            name: 'surat_petikan_akhir_staf'
        },
        {
            name: 'surat_distribusi_tgl',
            type: 'date'
        },
        {
            name: 'surat_distribusi_staf'
        },
        {
            name: 'surat_distribusi_profil'
        },
        {
            name: 'surat_selesai_tgl',
            type: 'date'
        },
        {
            name: 'surat_selesai_staf'
        },
        {
            name: 'surat_selesai_profil'
        },
        {
            name: 'surat_terima_staf'
        },
        {
            name: 'surat_israhasia'
        },
        {
            name: 'surat_ekspedisi'
        },
        {
            name: 'surat_nomor_isbatal',
            type: 'boolean'
        },
        {
            name: 'surat_nomor_batal_tgl',
            type: 'date'
        },
        {
            name: 'surat_nomor_batal_staf'
        },
        {
            name: 'surat_nomor_batal_profil'
        },
        {
            name: 'distributor_id'
        },
        {
            name: 'distributor_kode'
        },
        {
            name: 'distributor_nama'
        },
        {
            name: 'distributor_unit'
        },
        {
            name: 'distributor_unit_kode'
        },
        {
            name: 'distributor_unit_nama'
        },
        {
            name: 'distributor_jabatan'
        },
        {
            name: 'distributor_jabatan_kode'
        },
        {
            name: 'distributor_jabatan_nama'
        },
        {
            name: 'distributor_isaktif'
        },
        {
            name: 'penyetuju_id'
        },
        {
            name: 'penyetuju_kode'
        },
        {
            name: 'penyetuju_nama'
        },
        {
            name: 'penyetuju_unit'
        },
        {
            name: 'penyetuju_unit_kode'
        },
        {
            name: 'penyetuju_unit_nama'
        },
        {
            name: 'penyetuju_jabatan'
        },
        {
            name: 'penyetuju_jabatan_kode'
        },
        {
            name: 'penyetuju_jabatan_nama'
        },
        {
            name: 'penyetuju_isaktif'
        },
        {
            name: 'penyelesai_id'
        },
        {
            name: 'penyelesai_kode'
        },
        {
            name: 'penyelesai_nama'
        },
        {
            name: 'penyelesai_unit'
        },
        {
            name: 'penyelesai_unit_kode'
        },
        {
            name: 'penyelesai_unit_nama'
        },
        {
            name: 'penyelesai_jabatan'
        },
        {
            name: 'penyelesai_jabatan_kode'
        },
        {
            name: 'penyelesai_jabatan_nama'
        },
        {
            name: 'penyelesai_isaktif'
        },
        {
            name: 'penerima_id'
        },
        {
            name: 'penerima_kode'
        },
        {
            name: 'penerima_nama'
        },
        {
            name: 'penerima_unit'
        },
        {
            name: 'penerima_unit_kode'
        },
        {
            name: 'penerima_unit_nama'
        },
        {
            name: 'penerima_jabatan'
        },
        {
            name: 'penerima_jabatan_kode'
        },
        {
            name: 'penerima_jabatan_nama'
        },
        {
            name: 'penerima_isaktif'
        },
        {
            name: 'unit_id'
        },
        {
            name: 'unit_kode'
        },
        {
            name: 'unit_nama'
        },
        {
            name: 'media_id'
        },
        {
            name: 'media_nama'
        },
        {
            name: 'media_kode'
        },
        {
            name: 'media_isaktif'
        },
        {
            name: 'media_properti'
        },
        {
            name: 'prioritas_id'
        },
        {
            name: 'prioritas_kode'
        },
        {
            name: 'prioritas_nama'
        },
        {
            name: 'prioritas_retensi'
        },
        {
            name: 'prioritas_isaktif'
        },
        {
            name: 'prioritas_properti'
        },
        {
            name: 'jenis_id'
        },
        {
            name: 'jenis_nama'
        },
        {
            name: 'jenis_kode'
        },
        {
            name: 'jenis_isaktif'
        },
        {
            name: 'jenis_nomor_awal',
            type: 'boolean'
        },
        {
            name: 'jenis_retensi'
        },
        {
            name: 'jenis_properti'
        },
        {
            name: 'sifat_id'
        },
        {
            name: 'sifat_nama'
        },
        {
            name: 'sifat_kode'
        },
        {
            name: 'sifat_isaktif'
        },
        {
            name: 'sifat_properti'
        },
        {
            name: 'kelas_id'
        },
        {
            name: 'kelas_nama'
        },
        {
            name: 'kelas_kode'
        },
        {
            name: 'kelas_induk'
        },
        {
            name: 'kelas_retensi'
        },
        {
            name: 'kelas_inaktif'
        },
        {
            name: 'kelas_limitdays'
        },
        {
            name: 'kelas_isaktif'
        },
        {
            name: 'kelas_properti'
        },
        {
            name: 'lokasi_id'
        },
        {
            name: 'lokasi_nama'
        },
        {
            name: 'lokasi_kode'
        },
        {
            name: 'lokasi_induk'
        },
        {
            name: 'lokasi_isaktif'
        },
        {
            name: 'lokasi_properti'
        },
        {
            name: 'itipe_id'
        },
        {
            name: 'itipe_nama'
        },
        {
            name: 'itipe_kode'
        },
        {
            name: 'itipe_isaktif'
        },
        {
            name: 'itipe_properti'
        },
        {
            name: 'retensi_id'
        },
        {
            name: 'retensi_nama'
        },
        {
            name: 'retensi_hari'
        },
        {
            name: 'retensi_isaktif'
        },
        {
            name: 'retensi_properti'
        },
        {
            name: 'korespondensi_id'
        },
        {
            name: 'korespondensi_nomor'
        },
        {
            name: 'korespondensi_perihal'
        },
        {
            name: 'korespondensi_pengirim'
        },
        {
            name: 'korespondensi_penerima'
        },
        {
            name: 'korespondensi_isinternal'
        },
        {
            name: 'korespondensi_properti'
        },
        {
            name: 'surat_properti_id'
        },
        {
            name: 'surat_properti_buat_tgl',
            type: 'date'
        },
        {
            name: 'surat_properti_pembuat_id'
        },
        {
            name: 'surat_properti_pembuat_kode'
        },
        {
            name: 'surat_properti_pembuat_nama'
        },
        {
            name: 'surat_properti_pembuat_unit'
        },
        {
            name: 'surat_properti_pembuat_unit_nama'
        },
        {
            name: 'surat_properti_pembuat_jabatan'
        },
        {
            name: 'surat_properti_pembuat_jabatan_nama'
        },
        {
            name: 'surat_properti_pembuat_isaktif'
        },
        {
            name: 'surat_properti_ubah_tgl',
            type: 'date'
        },
        {
            name: 'surat_properti_pengubah_id'
        },
        {
            name: 'surat_properti_pengubah_kode'
        },
        {
            name: 'surat_properti_pengubah_nama'
        },
        {
            name: 'surat_properti_pengubah_unit'
        },
        {
            name: 'surat_properti_pengubah_unit_nama'
        },
        {
            name: 'surat_properti_pengubah_jabatan'
        },
        {
            name: 'surat_properti_pengubah_jabatan_nama'
        },
        {
            name: 'surat_properti_pengubah_isaktif'
        },
        {
            name: 'surat_properti_hapus_tgl',
            type: 'date'
        },
        {
            name: 'surat_properti_penghapus_id'
        },
        {
            name: 'surat_properti_penghapus_kode'
        },
        {
            name: 'surat_properti_penghapus_nama'
        },
        {
            name: 'surat_properti_penghapus_unit'
        },
        {
            name: 'surat_properti_penghapus_unit_nama'
        },
        {
            name: 'surat_properti_penghapus_jabatan'
        },
        {
            name: 'surat_properti_penghapus_jabatan_nama'
        },
        {
            name: 'surat_properti_penghapus_isaktif'
        },
        {
            name: 'surat_properti_pulih_tgl',
            type: 'date'
        },
        {
            name: 'surat_properti_pemulih_id'
        },
        {
            name: 'surat_properti_pemulih_kode'
        },
        {
            name: 'surat_properti_pemulih_nama'
        },
        {
            name: 'surat_properti_pemulih_unit'
        },
        {
            name: 'surat_properti_pemulih_unit_nama'
        },
        {
            name: 'surat_properti_pemulih_jabatan'
        },
        {
            name: 'surat_properti_pemulih_jabatan_nama'
        },
        {
            name: 'surat_properti_pemulih_isaktif'
        },
        {
            name: 'surat_properti_ishapus'
        },
        {
            name: 'surat_properti_data'
        },
        {
            name: 'korespondensi_unitpengirim'
        },
        {
            name: 'korespondensi_unitpenerima'
        },
        {
            convert: function(v, rec) {
                if(rec.get('surat_model') === rec.self.modelType().MODEL_MASUK){
                    return rec.self.modelType().MODEL_MASUK_DISPLAY;
                }else if (rec.get('surat_model') === rec.self.modelType().MODEL_KELUAR){
                    return rec.self.modelType().MODEL_KELUAR_DISPLAY;
                }else if (rec.get('surat_model') === rec.self.modelType().MODEL_IKELUAR){
                    return rec.self.modelType().MODEL_IKELUAR_DISPLAY;
                }else if (rec.get('surat_model') === rec.self.modelType().MODEL_IMASUK){
                    return rec.self.modelType().MODEL_IMASUK_DISPLAY;
                }else if (rec.get('surat_model') === rec.self.modelType().MODEL_BEBAS){
                    return rec.self.modelType().MODEL_BEBAS_DISPLAY;
                }else if (rec.get('surat_model') === rec.self.modelType().MODEL_KEPUTUSAN){
                    return rec.self.modelType().MODEL_KEPUTUSAN_DISPLAY;
                }
            },
            name: 'surat_tipe'
        },
        {
            name: 'ekspedisi_id'
        },
        {
            name: 'ekspedisi_kode'
        },
        {
            name: 'ekspedisi_nama'
        },
        {
            name: 'surat_isdistribusi',
            type: 'int'
        },
        {
            name: 'surat_isterima',
            type: 'int'
        },
        {
            name: 'surat_isselesai',
            type: 'int'
        },
        {
            name: 'surat_usesla'
        },
        {
            name: 'surat_lampiran_sub'
        },
        {
            name: 'surat_usesetuju',
            type: 'int'
        },
        {
            name: 'surat_setuju_komentar'
        },
        {
            name: 'surat_prioritas_tgl',
            type: 'date'
        },
        {
            name: 'surat_sla'
        },
        {
            name: 'surat_ulasan_nilai',
            type: 'int'
        },
        {
            name: 'surat_ulasan_komentar'
        },
        {
            name: 'surat_setuju_setuju',
            type: 'int'
        },
        {
            name: 'surat_setuju_total',
            type: 'int'
        },
        {
            name: 'surat_usebalas',
            type: 'boolean'
        },
        {
            name: 'surat_isnomor',
            type: 'int'
        },
        {
            name: 'surat_arah_tgl',
            type: 'date'
        },
        {
            name: 'surat_arah_staf'
        },
        {
            name: 'surat_arah_profil'
        },
        {
            name: 'surat_isarah',
            type: 'int'
        },
        {
            name: 'pengarah_id'
        },
        {
            name: 'pengarah_kode'
        },
        {
            name: 'pengarah_nama'
        },
        {
            name: 'pengarah_unit'
        },
        {
            name: 'pengarah_unit_kode'
        },
        {
            name: 'pengarah_unit_nama'
        },
        {
            name: 'pengarah_jabatan'
        },
        {
            name: 'pengarah_jabatan_kode'
        },
        {
            name: 'pengarah_jabatan_nama'
        },
        {
            name: 'surat_lokasi_sub'
        },
        {
            name: 'surat_kepada'
        },
        {
            name: 'surat_induk_nomor'
        },
        {
            name: 'surat_induk_id'
        },
        {
            name: 'surat_imasuk_setuju'
        },
        {
            name: 'surat_imasuk_total'
        },
        {
            name: 'surat_distribusi_otomatis',
            type: 'int'
        },
        {
            name: 'penilai_id'
        },
        {
            name: 'penilai_kode'
        },
        {
            name: 'penilai_nama'
        },
        {
            name: 'penilai_unit'
        },
        {
            name: 'penilai_unit_kode'
        },
        {
            name: 'penilai_unit_nama'
        },
        {
            name: 'penilai_unit_rubrik'
        },
        {
            name: 'penilai_jabatan'
        },
        {
            name: 'penilai_jabatan_kode'
        },
        {
            name: 'penilai_jabatan_nama'
        },
        {
            name: 'surat_sla_nilai',
            type: 'int'
        },
        {
            name: 'surat_sla_tgl',
            type: 'date'
        },
        {
            name: 'surat_sla_staf'
        },
        {
            name: 'surat_sla_formula'
        },
        {
            name: 'surat_induk_setuju_tgl',
            type: 'date'
        },
        {
            name: 'surat_setuju_rentang'
        },
        {
            name: 'surat_jumlah_dokumen',
            type: 'int'
        },
        {
            name: 'korespondensi_unitpengirim_nama'
        },
        {
            name: 'korespondensi_unitpenerima_nama'
        },
        {
            name: 'penolak_sla_id'
        },
        {
            name: 'penolak_sla_kode'
        },
        {
            name: 'penolak_sla_nama'
        },
        {
            name: 'penolak_sla_unit'
        },
        {
            name: 'penolak_sla_unit_kode'
        },
        {
            name: 'penolak_sla_unit_nama'
        },
        {
            name: 'penolak_sla_unit_rubrik'
        },
        {
            name: 'penolak_sla_jabatan'
        },
        {
            name: 'penolak_sla_jabatan_kode'
        },
        {
            name: 'penolak_sla_jabatan_nama'
        },
        {
            name: 'surat_sla_tolak_tgl',
            type: 'date'
        },
        {
            name: 'surat_sla_tolak_staf'
        },
        {
            name: 'surat_sla_tolak_komentar'
        },
        {
            name: 'surat_sla_istolak',
            type: 'int'
        },
        {
            name: 'surat_sla_tolak_baca_tgl',
            type: 'date'
        },
        {
            name: 'surat_sla_tolak_baca_staf'
        },
        {
            name: 'surat_tolak_baca_tgl',
            type: 'date'
        },
        {
            name: 'surat_tolak_baca_staf'
        },
        {
            name: 'surat_ulasan_baca_tgl',
            type: 'date'
        },
        {
            name: 'surat_ulasan_baca_staf'
        },
        {
            name: 'surat_ulasan_baca_profil'
        },
        {
            name: 'surat_sla_tolak_isbaca',
            type: 'int'
        },
        {
            name: 'surat_tolak_isbaca',
            type: 'int'
        },
        {
            name: 'surat_ulasan_isbaca',
            type: 'int'
        },
        {
            name: 'surat_imasuk_tolak',
            type: 'int'
        },
        {
            name: 'surat_sla_tolak_jumlah',
            type: 'int'
        },
        {
            name: 'surat_ulasan_jumlah',
            type: 'int'
        },
        {
            name: 'surat_imasuk_ulasan_jumlah',
            type: 'int'
        },
        {
            name: 'surat_sorter',
            type: 'int'
        },
        {
            name: 'surat_ulasan_nilai_rata',
            type: 'float'
        },
        {
            name: 'sifat_color'
        },
        {
            name: 'surat_nomor_tgl',
            type: 'date'
        },
        {
            name: 'surat_keterangan'
        },
        {
            name: 'surat_induk_unit'
        },
        {
            name: 'surat_induk_unit_nama'
        },
        {
            name: 'surat_imasuk_pending',
            type: 'int'
        },
        {
            name: 'surat_setuju_tolak',
            type: 'int'
        },
        {
            name: 'surat_setuju_pending',
            type: 'int'
        },
        {
            name: 'surat_alamat'
        },
        {
            name: 'unit_source_id'
        },
        {
            name: 'unit_source_kode'
        },
        {
            name: 'unit_source_nama'
        },
        {
            name: 'surat_unit_source'
        },
        {
            name: 'surat_jumlah_dokumen_reupload',
            type: 'int'
        },
        {
            name: 'surat_ekspedisi_tgl',
            type: 'date'
        },
        {
            name: 'surat_berlaku_tgl',
            type: 'date'
        },
        {
            name: 'surat_isbackdate',
            type: 'int'
        },
        {
            name: 'surat_nomor_urut'
        },
        {
            name: 'surat_nomor_backdate'
        },
        {
            name: 'surat_nomor_format'
        },
        {
            name: 'jenis_batasibackdate',
            type: 'boolean'
        },
        {
            name: 'jenis_batasipenerima',
            type: 'boolean'
        },
        {
            name: 'jenis_ttd',
            type: 'boolean'
        },
        {
            name: 'jenis_isbatas',
            type: 'boolean'
        },
        {
            name: 'jenis_batas_jumlah'
        },
        {
            name: 'surat_setuju_akhir_staf'
        },
        {
            name: 'surat_nomor_issalin',
            type: 'boolean'
        },
        {
            name: 'pembatal_id'
        },
        {
            name: 'pembatal_nama'
        },
        {
            name: 'pembatal_unit'
        },
        {
            name: 'pembatal_unit_nama'
        },
        {
            name: 'pembatal_jabatan'
        },
        {
            name: 'pembatal_jabatan_nama'
        },
        {
            name: 'surat_ismusnah',
            type: 'boolean'
        },
        {
            name: 'surat_musnah_tgl',
            type: 'date'
        },
        {
            name: 'surat_musnah_staf'
        },
        {
            name: 'pemusnah_id'
        },
        {
            name: 'pemusnah_nama'
        },
        {
            name: 'pemusnah_unit'
        },
        {
            name: 'pemusnah_unit_nama'
        },
        {
            name: 'pemusnah_jabatan'
        },
        {
            name: 'pemusnah_jabatan_nama'
        },
        {
            name: 'surat_isarsip',
            type: 'boolean'
        },
        {
            name: 'surat_arsip_tgl',
            type: 'date'
        },
        {
            name: 'surat_arsip_staf'
        },
        {
            name: 'surat_arsip_profil'
        },
        {
            name: 'pengarsip_id'
        },
        {
            name: 'pengarsip_nama'
        },
        {
            name: 'pengarsip_unit'
        },
        {
            name: 'pengarsip_unit_nama'
        },
        {
            name: 'pengarsip_jabatan'
        },
        {
            name: 'pengarsip_jabatan_nama'
        },
        {
            name: 'surat_inaktif_tgl',
            type: 'date'
        },
        {
            name: 'surat_distribusi_iscabut',
            type: 'boolean'
        },
        {
            name: 'surat_distribusi_cabut_tgl',
            type: 'date'
        },
        {
            name: 'surat_distribusi_cabut_staf'
        },
        {
            name: 'surat_distribusi_cabut_profil'
        },
        {
            name: 'surat_distribusi_cabut_pesan'
        },
        {
            name: 'distributor_cabut_id'
        },
        {
            name: 'distributor_cabut_nama'
        },
        {
            name: 'distributor_cabut_unit'
        },
        {
            name: 'distributor_cabut_unit_nama'
        },
        {
            name: 'distributor_cabut_jabatan'
        },
        {
            name: 'distributor_cabut_jabatan_nama'
        },
        {
            name: 'surat_useberkas',
            type: 'boolean'
        },
        {
            name: 'disposisi_jumlah_berkas_request',
            type: 'int'
        },
        {
            name: 'surat_petikan_setuju_total'
        },
        {
            name: 'surat_petikan_setuju_setuju'
        },
        {
            name: 'surat_petikan_setuju_tolak'
        },
        {
            name: 'surat_petikan_setuju_pending'
        },
        {
            name: 'surat_penerimask_total'
        },
        {
            name: 'sub_tipe'
        },
        {
            name: 'surat_milik_kode'
        },
        {
            name: 'surat_pmu_mode'
        }
    ],

    hasOne: [
        {
            model: 'SIPAS.model.Sipas.Arsip',
            primaryKey: 'arsip_id',
            foreignKey: 'surat_arsip',
            getterName: 'getArsip',
            setterName: 'setArsip'
        },
        {
            model: 'SIPAS.model.Sipas.Surat',
            primaryKey: 'surat_id',
            foreignKey: 'surat_id',
            getterName: 'getSurat',
            setterName: 'setSurat'
        },
        {
            model: 'SIPAS.model.Sipas.Surat',
            primaryKey: 'surat_id',
            foreignKey: 'surat_korespondensi_surat',
            getterName: 'getKorespondensiSurat',
            setterName: 'setKorespondensiSurat'
        },
        {
            associationKey: 'surat_ulasan_surat',
            model: 'SIPAS.model.Sipas.surat.Ulasan',
            primaryKey: 'surat_id',
            getterName: 'getUlasan',
            setterName: 'setUlasan'
        },
        {
            model: 'SIPAS.model.Sipas.surat.Ulasan',
            primaryKey: 'surat_id',
            foreignKey: 'surat_ulasan_surat',
            getterName: 'getUlasan',
            setterName: 'setUlasan'
        },
        {
            model: 'SIPAS.model.Sipas.Jenis',
            primaryKey: 'jenis_id',
            foreignKey: 'surat_jenis',
            getterName: 'getJenis',
            setterName: 'setJenis'
        },
        {
            storeConfig: {
                proxy: {
                    type: 'ajax',
                    url: 'server.php/sipas/jenis/masterSubJenis',
                    reader: {
                        type: 'json',
                        root: 'data'
                    }
                }
            },
            model: 'SIPAS.model.Sipas.jenis.Sub',
            primaryKey: 'sub_id',
            foreignKey: 'surat_jenis_sub',
            getterName: 'getJenisSub',
            setterName: 'setJenisSub'
        },
        {
            model: 'SIPAS.model.Sipas.Media',
            primaryKey: 'media_id',
            foreignKey: 'surat_media',
            getterName: 'getMedia',
            setterName: 'setMedia'
        },
        {
            model: 'SIPAS.model.Sipas.Lokasi',
            primaryKey: 'lokasi_id',
            foreignKey: 'surat_lokasi',
            getterName: 'getLokasi',
            setterName: 'setLokasi'
        },
        {
            model: 'SIPAS.model.Sipas.Kelas',
            primaryKey: 'kelas_id',
            foreignKey: 'surat_kelas',
            getterName: 'getKelas',
            setterName: 'setKelas'
        },
        {
            model: 'SIPAS.model.Sipas.Prioritas',
            primaryKey: 'prioritas_id',
            foreignKey: 'surat_prioritas',
            getterName: 'getPrioritas',
            setterName: 'setPrioritas'
        },
        {
            model: 'SIPAS.model.Sipas.Sifat',
            primaryKey: 'sifat_id',
            foreignKey: 'surat_sifat',
            getterName: 'getSifat',
            setterName: 'setSifat'
        },
        {
            model: 'SIPAS.model.Sipas.Unit',
            primaryKey: 'unit_id',
            foreignKey: 'surat_unit',
            getterName: 'getUnit',
            setterName: 'setUnit'
        },
        {
            model: 'SIPAS.model.Sipas.uni.Source',
            primaryKey: 'unit_id',
            foreignKey: 'surat_unit_source',
            getterName: 'getSourceUnit',
            setterName: 'setSourceUnit'
        }
    ],

    belongsTo: {
        model: 'SIPAS.model.Sipas.Korespondensi',
        primaryKey: 'surat_korespondensi',
        foreignKey: 'korespondensi_id',
        getterName: 'getKorespondensi',
        setterName: 'setKorespondensi'
    },

    hasMany: [
        {
            model: 'SIPAS.model.Sipas.surat.stack.Koreksi',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchStackKoreksi',
            storeConfig: {
                pageSize: 1000,
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.stack.Petikan',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchStackPetikan',
            storeConfig: {
                pageSize: 1000,
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.Penerimask',
            primaryKey: 'surat_id',
            foreignKey: 'surat_penerimask_surat',
            name: 'fetchPenerimask',
            storeConfig: {
                pageSize: 1000,
                sorters: {
                    property: 'surat_penerimask_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.stack.Disposisi',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchTembusansk',
            storeConfig: {
                proxy: {
                    type: 'ajax',
                    url: 'server.php/sipas/surat_stack/disposisi/tembusan',
                    reader: {
                        type: 'json',
                        root: 'data'
                    }
                },
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.stack.Disposisi',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchPenerima',
            storeConfig: {
                proxy: {
                    type: 'ajax',
                    url: 'server.php/sipas/surat_stack/disposisi/penerima',
                    reader: {
                        type: 'json',
                        root: 'data'
                    }
                },
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.stack.Disposisi',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchStackPenerimaKeluar',
            storeConfig: {
                proxy: {
                    type: 'ajax',
                    url: 'server.php/sipas/surat_stack/disposisi/penerimakeluar',
                    reader: {
                        type: 'json',
                        root: 'data'
                    }
                },
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.stack.Disposisi',
            primaryKey: 'surat_id',
            foreignKey: 'surat_stack_surat',
            name: 'fetchStackDisposisi',
            storeConfig: {
                pageSize: 1000,
                sorters: {
                    property: 'surat_stack_level'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.Surat',
            primaryKey: 'surat_id',
            foreignKey: 'surat_korespondensi_surat',
            name: 'fetchKorespondensi'
        },
        {
            model: 'SIPAS.model.Sipas.surat.Log',
            primaryKey: 'surat_id',
            foreignKey: 'surat_log_surat',
            name: 'fetchLog',
            storeConfig: {
                proxy: {
                    type: 'ajax',
                    url: 'server.php/sipas/surat_log/ekspedisi',
                    reader: {
                        type: 'json',
                        root: 'data'
                    }
                },
                sorters: {
                    direction: 'DESC',
                    property: 'surat_log_tgl'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.Log',
            primaryKey: 'surat_id',
            foreignKey: 'surat_log_surat',
            name: 'fetchLog2',
            storeConfig: {
                sorters: {
                    direction: 'DESC',
                    property: 'surat_log_tgl'
                }
            }
        },
        {
            model: 'SIPAS.model.Sipas.surat.Ulasan',
            primaryKey: 'surat_id',
            foreignKey: 'surat_ulasan_surat',
            name: 'fetchUlasan'
        },
        {
            model: 'SIPAS.model.Sipas.koreksi.Riwayat',
            primaryKey: 'surat_id',
            foreignKey: 'disposisi_surat',
            name: 'fetchKoreksiRiwayat',
            storeConfig: {
                sorters: [
                    {
                        direction: 'ASC',
                        property: 'disposisi_tgl'
                    }
                ]
            }
        }
    ],

    arahkan: function(config) {
        config = Ext.apply({
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_arah_tgl' : new Date(),
            'surat_arah_staf' : config.staf,
            'surat_unit' : config.unit
        });
        this.save(config);
    },

    getApproval: function() {
        return this.get('surat_setuju');
    },

    getApprovalInfo: function() {
        return {
            status: this.getApproval(),
            approver: this.get('surat_setuju_staf')
        };
    },

    approve: function(config) {
        config = Ext.apply({
            status: config.status,
            approver: null,
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_setuju': config.status,
            'surat_setuju_staf': config.approver,
            'surat_setuju_tgl': new Date(),
            'surat_retensi': config.retensi,
            'surat_useretensi': config.useRetensi,
            'surat_korespondensi' : config.korespondensi,
            'surat_korespondensi_surat' : config.korespondensi_surat,
            'korespondensi_isinternal' : config.korespondensi_isinternal
        });
        this.save(config);
    },

    distribute: function(config) {
        config = Ext.apply({
            distributor: null,
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_distribusi_staf': config.distributor,
            'surat_distribusi_tgl': new Date()
        });
        this.save(config);
    },

    done: function(config) {
        config = Ext.apply({
            pic: null,
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_selesai_staf': config.pic,
            'surat_selesai_tanggal': new Date()
        });
        this.save(config);
    },

    readingTolak: function(config) {
        config = Ext.apply({
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_tolak_baca_staf' : config.staf,
            'surat_tolak_baca_tgl': new Date()
        });
        this.save(config);
    },

    readingSlaTolak: function(config) {
        config = Ext.apply({
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_sla_tolak_baca_staf' : config.staf,
            'surat_sla_tolak_baca_tgl': new Date()
        });
        this.save(config);
    },

    readingUlasan: function(config) {
        config = Ext.apply({
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        this.set({
            'surat_ulasan_baca_staf' : config.staf,
            'surat_ulasan_baca_tgl': new Date()
        });
        this.save(config);
    },

    isMasuk: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_MASUK) return true;
            else return false;
    },

    isKeluar: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_KELUAR) return true;
            else return false;
    },

    isIMasuk: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_IMASUK) return true;
            else return false;
    },

    isIKeluar: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_IKELUAR) return true;
            else return false;
    },

    isBebas: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_BEBAS) return true;
            else return false;
    },

    isKeputusan: function() {
        if(this.get('surat_model') == this.self.modelType().MODEL_KEPUTUSAN) return true;
            else return false;
    },

    getModelDisplay: function() {
        if(this.isMasuk()) return 'Surat Masuk Eksternal';
        else if(this.isKeluar()) return 'Surat Keluar Eksternal';
        else if(this.isIMasuk()) return 'Surat Masuk Internal';
        else if(this.isIKeluar()) return 'Surat Keluar Internal';
        else if(this.isBebas()) return 'Arsip Bebas';
        else if(this.isKeputusan()) return 'Surat Keputusan Internal';
        else return this.get('surat_model');
    },

    getPengirim: function() {
        if(this.isMasuk()) return this.get('surat_pengirim');
        else if(this.isKeluar()) return this.get('surat_tujuan');
        else if(this.isIMasuk()) return this.get('unit_nama');
        else if(this.isIKeluar()) return this.get('unit_nama');
        else if(this.isKeputusan()) return this.get('unit_nama');
        else return this.get('surat_pengirim');
    },

    save: function() {
        var proxy = this.getProxy();
            modelType = this.getModelType(),
            customApi = proxy.apis[modelType];

        if(customApi)
        {
            proxy.api = customApi;
        }

        this.callParent(arguments);
    },

    destroy: function() {
        var proxy = this.getProxy();
            modelType = this.getModelType(),
            customApi = proxy.apis[modelType];

        if(customApi)
        {
            proxy.api = customApi;
        }

        this.callParent(arguments);
    },

    getModelType: function() {
        if(this.isMasuk()) return 'masuk';
            else if(this.isKeluar()) return 'keluar';
            else if(this.isIMasuk()) return 'imasuk';
            else if(this.isIKeluar()) return 'ikeluar';
            else if(this.isBebas()) return 'bebas';
            else if(this.isKeputusan()) return 'keputusan';
            else return this.get('surat_model');
    }

});