/*
 * File: app/model/Sipas/masuk/Penerima.js
 *
 * This file was generated by Sencha Architect version 3.5.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('SIPAS.model.Sipas.masuk.Penerima', {
    extend: 'Ext.data.Model',

    requires: [
        'Ext.data.Field',
        'Ext.data.proxy.Ajax',
        'Ext.data.reader.Json',
        'Ext.data.association.HasOne',
        'Ext.data.association.HasMany'
    ],
    uses: [
        'SIPAS.model.Sipas.Surat',
        'SIPAS.model.Sipas.Disposisi',
        'SIPAS.model.Sipas.disposisi.Masuk',
        'SIPAS.model.Sipas.Staf',
        'SIPAS.model.Sipas.Aksi',
        'SIPAS.model.Sipas.disposisi.Riwayat'
    ],

    idProperty: 'disposisi_penerima_id',

    fields: [
        {
            name: 'disposisi_penerima_id'
        },
        {
            name: 'disposisi_penerima_kode'
        },
        {
            name: 'disposisi_penerima_penerima'
        },
        {
            name: 'disposisi_penerima_disposisi'
        },
        {
            name: 'disposisi_penerima_status',
            type: 'int'
        },
        {
            name: 'disposisi_penerima_komentar'
        },
        {
            name: 'disposisi_penerima_keterangan'
        },
        {
            name: 'disposisi_penerima_aksi'
        },
        {
            name: 'disposisi_penerima_istembusan',
            type: 'boolean'
        },
        {
            name: 'disposisi_penerima_isberkas',
            type: 'boolean'
        },
        {
            name: 'disposisi_penerima_isterima',
            type: 'int'
        },
        {
            name: 'disposisi_penerima_isbaca',
            type: 'int'
        },
        {
            name: 'disposisi_penerima_isforward',
            type: 'int'
        },
        {
            name: 'disposisi_penerima_forward_tanggal',
            type: 'date'
        },
        {
            name: 'disposisi_penerima_baca_tanggal',
            type: 'date'
        },
        {
            name: 'disposisi_penerima_penerima_record'
        },
        {
            name: 'disposisi_id'
        },
        {
            name: 'disposisi_kode'
        },
        {
            name: 'disposisi_pengirim'
        },
        {
            name: 'disposisi_induk'
        },
        {
            name: 'disposisi_tanggal',
            type: 'date'
        },
        {
            name: 'disposisi_surat'
        },
        {
            name: 'disposisi_text'
        },
        {
            name: 'disposisi_perintah'
        },
        {
            name: 'perintah_id'
        },
        {
            name: 'perintah_text'
        },
        {
            name: 'disposisi_isdisposisi',
            type: 'int'
        },
        {
            dateFormat: 'd M Y',
            name: 'surat_pembuatan_tanggal',
            type: 'date'
        },
        {
            name: 'surat_registrasi'
        },
        {
            name: 'surat_id'
        },
        {
            convert: function(v, rec) {
                if(rec.get('surat_masuk') !== null){
                    return '<span style="color: #2196F3">EKSTERNAL</>';
                }else if(rec.get('surat_konsep') !== null){
                    return '<span style="color: grey">KONSEP SURAT</>';
                }else if(rec.get('surat_internal') !== null){
                    return '<span style="color: #FFA000">INTERNAL</>';
                }
            },
            name: 'surat_tipe'
        },
        {
            name: 'surat_model'
        },
        {
            name: 'surat_masuk'
        },
        {
            name: 'surat_keluar'
        },
        {
            name: 'surat_konsep'
        },
        {
            name: 'surat_internal'
        },
        {
            name: 'surat_buat_staf'
        },
        {
            name: 'surat_setuju_staf'
        },
        {
            name: 'surat_penyetujuan_tanggal'
        },
        {
            name: 'surat_penyetujuan_status'
        },
        {
            convert: function(v, rec) {
                switch( rec.get('surat_penyetujuan_status') ){
                    case rec.statics.readStatus.APPROVE:
                    return "Dikirim";
                    case rec.statics.readStatus.INIT:
                    return "Belum Didistribusikan";
                    case rec.statics.readStatus.DISPOSISI:
                    return "Diajukan";
                    case rec.statics.readStatus.FORWARD:
                    return "Dalam Proses";
                }
            },
            name: 'surat_penyetujuan_status_text'
        },
        {
            name: 'surat_korespondensi'
        },
        {
            name: 'korespondensi_kode'
        },
        {
            name: 'surat_korespondensi_surat'
        },
        {
            name: 'surat_rak'
        },
        {
            name: 'surat_jenis'
        },
        {
            name: 'surat_kelas'
        },
        {
            name: 'surat_asal'
        },
        {
            name: 'surat_derajat'
        },
        {
            name: 'surat_agenda'
        },
        {
            name: 'surat_agenda_sub'
        },
        {
            name: 'surat_nomor'
        },
        {
            name: 'surat_perihal'
        },
        {
            name: 'surat_pengirim'
        },
        {
            name: 'surat_tujuan'
        },
        {
            name: 'surat_tanggal'
        },
        {
            name: 'surat_useretensi'
        },
        {
            name: 'surat_retensi'
        },
        {
            name: 'media_id'
        },
        {
            name: 'media_kode'
        },
        {
            name: 'media_nama'
        },
        {
            name: 'prioritas_id'
        },
        {
            name: 'prioritas_kode'
        },
        {
            name: 'prioritas_nama'
        },
        {
            name: 'jenis_id'
        },
        {
            name: 'jenis_kode'
        },
        {
            name: 'jenis_nama'
        },
        {
            name: 'sifat_id'
        },
        {
            name: 'sifat_kode'
        },
        {
            name: 'sifat_nama'
        },
        {
            name: 'lokasi_id'
        },
        {
            name: 'lokasi_kode'
        },
        {
            name: 'lokasi_nama'
        },
        {
            name: 'pembuat_id'
        },
        {
            name: 'pembuat_nama'
        },
        {
            name: 'pembuat_unitkerja'
        },
        {
            name: 'pembuat_unitkerja_kode'
        },
        {
            name: 'pembuat_unitkerja_nama'
        },
        {
            name: 'penyetuju_id'
        },
        {
            name: 'penyetuju_nama'
        },
        {
            name: 'penerima_id'
        },
        {
            name: 'penerima_nama'
        },
        {
            name: 'penerima_unitkerja_nama'
        },
        {
            name: 'penerima_jabatan_nama'
        },
        {
            name: 'kelas_id'
        },
        {
            name: 'kelas_kode'
        },
        {
            name: 'kelas_nama'
        },
        {
            name: 'unitkerja_pengirim_id'
        },
        {
            name: 'unitkerja_pengirim_nama'
        },
        {
            name: 'unitkerja_pengirim_kode'
        }
    ],

    proxy: {
        type: 'ajax',
        api: {
            read: 'server.php/sipas/surat_masuk_penerima/read',
            create: 'server.php/sipas/disposisi_penerima/create',
            update: 'server.php/sipas/disposisi_penerima/update',
            destroy: 'server.php/sipas/disposisi_penerima/destroy'
        },
        reader: {
            type: 'json',
            root: 'data'
        }
    },

    hasOne: [
        {
            model: 'SIPAS.model.Sipas.Surat',
            primaryKey: 'surat_id',
            foreignKey: 'disposisi_surat',
            getterName: 'getSurat',
            setterName: 'setSurat'
        },
        {
            model: 'SIPAS.model.Sipas.Disposisi',
            primaryKey: 'disposisi_id',
            foreignKey: 'disposisi_penerima_disposisi',
            getterName: 'getDisposisi',
            setterName: 'setDisposisi'
        },
        {
            model: 'SIPAS.model.Sipas.disposisi.Masuk',
            primaryKey: 'disposisi_masuk_id',
            foreignKey: 'disposisi_penerima_id',
            getterName: 'getDisposisiPenerima',
            setterName: 'setDisposisiPenerima'
        },
        {
            associationKey: 'disposisi_penerima_penerima_record',
            model: 'SIPAS.model.Sipas.Staf',
            primaryKey: 'staf_id',
            foreignKey: 'disposisi_penerima_penerima',
            getterName: 'getPenerima',
            setterName: 'setPenerima'
        },
        {
            model: 'SIPAS.model.Sipas.Aksi',
            primaryKey: 'aksi_id',
            foreignKey: 'disposisi_penerima_aksi',
            getterName: 'getAksi',
            setterName: 'setAksi'
        }
    ],

    hasMany: [
        {
            model: 'SIPAS.model.Sipas.disposisi.Masuk',
            primaryKey: 'disposisi_masuk_id',
            foreignKey: 'disposisi_induk',
            name: 'fetchRiwayatPenerima'
        },
        {
            model: 'SIPAS.model.Sipas.disposisi.Riwayat',
            primaryKey: 'disposisi_penerima_id',
            foreignKey: 'disposisi_induk',
            name: 'fetchRiwayat'
        }
    ],

    constructor: function() {
        var me = this;
        me.processSipasmasukPenerima(me);
        me.callParent(arguments);
    },

    processSipasmasukPenerima: function(config) {
        return Ext.apply(config,{
            statics : {
                readStatus: {
                    INIT:0,
                    UNREAD: 0,
                    READ: 1,
                    DISPOSISI: 2,
                    FORWARD: 2,
                    APPROVE: 3,
                    DECLINE: 4
                }
            }
        });
    },

    forwarding: function(config) {
        if(this.get('disposisi_penerima_status') == this.statics.readStatus.FORWARD) return;
        config = Ext.apply({
            callback: Ext.emptyFn,
            success: Ext.emptyFn,
            failure: Ext.emptyFn,
            scope: this
        }, config);

        config.status = this.statics.readStatus.FORWARD;
        this.set({
            'disposisi_penerima_status': config.status
        });
        this.save(config);
    },

    genSender: function() {
        if(!this.get('disposisi_induk')){
            return "<span class='alternaive'>[ mailroom ]</span>";
        }
        return val;
    },

    genTembusan: function() {
        var tembusan = this.get('disposisi_penerima_istembusan');
                if(tembusan == '1'){
                    return  "<span style='color:#3D833D'><i class='icon ion-md-person grey-600-i'></i>Tembusan</span>";
                }
    }

});